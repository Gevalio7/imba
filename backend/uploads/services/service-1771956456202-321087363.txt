CREW. Как обновить данные по должностям, возрасту и базовому аэропорту из САП
•	1. Описание 
o	1.1. Суть проблемы
•	2. Порядок действий 
o	2.1. Сбор списка табельников для обновления 
	2.1.1. Пример
o	2.2. Подготовка данных для получения данных из САП 
	2.2.1. Совсем вручную
	2.2.2. Полуавтомат с парсером пока adp-sap на тесте не работает
	2.2.3. Полуавтомат с парсером когда adp-sap на тесте будет работать
o	2.3. Основной запрос, которым можно проверять актуальность данных
o	2.4. Обновление данных по данным из САП в employee 
	2.4.1. Сгененировать обновление для таблицы employee (ФИО, возраст, гражданство) 
	2.4.1.1. Пример получившегося скрипта
	2.4.2. На деве меньше сотрудников, чем на Проде
	2.4.3. Сгененировать обновление для таблицы flight-info (базовый аэропорт) 
	2.4.3.1. Пример после генерации
	2.4.4. Сгененировать обновление для таблицы personnel_object_link (должности) 
	2.4.4.1. Заполнить файл EXCEL для сравнения:
	2.4.4.2. Анализ файла Excel 
	2.4.4.2.1. Анализ записей с одинаковыми табельными номерами
	2.4.4.2.2. Анализ записей с разными табельными номерами
	2.4.4.3. Генерация скриптов 
	2.4.4.3.1. восстановление неактуальной записи (RENEW) 
	2.4.4.3.1.1. Пример сгенерированных обновлений
	2.4.4.3.2. обновление неактивной записи (UPDATE_exp) 
	2.4.4.3.2.1. Пример сгенерированных обновлений
	2.4.4.3.3. обновление активной записи (UPDATE) 
	2.4.4.3.3.1. Пример сгенерированных обновлений
	2.4.4.3.4. добавление (INSERT) 
	2.4.4.3.4.1. Пример сгенерированных обновлений
	2.4.5. Сгененировать обновление для таблицы title_dep_summary (должности и подразделения):
	2.4.6. Сгененировать обновление для таблицы department_position_info (должности и тип сотрудника в прошлом)
o	2.5. Собрать скрипт 
	2.5.1. Пример после генерации
o	2.6. Проверка на деве
o	2.7. Выкатка в прод
1. Описание
На странице представлена инструкция как обновить данные по должностям, возрасту и базовому аэропорту из САП вручную. В рамках такого обновления будут обновлены записи только в основных таблицах. Данные в таблицах с историей останутся без изменений
1.1. Суть проблемы
Почему у сотрудников неактуальные данные?:
1.	Обработчик сообщений САП работает некорректно
2.	САП не прислали нужные данные (тут надо просить САП прислать повторно данные по сотруднику - P0002, P0001, P1001)
Так как обработчик САП работает некорректно, то на момент обновления данных на самом деле расхождения в данных обычно более масштабные, просто пользователи не сразу могут это заметить.
2. Порядок действий
2.1. Сбор списка табельников для обновления
Так как обработчик САП работает некорректно, то на момент обновления данных на самом деле расхождения в данных обычно более масштабные, просто пользователи не сразу могут это заметить.
Поэтому сбор табельников нужно выполнить из следующих источников:
1.	Инциденты
2.	Аккорд: список изменений в должностях с последней даты обновления должностей (я беру по умолчанию 50 дней назад)
3.	Все работающие сотрудники без должностей или у которых должность в title_dep_summary не совпадает с должностью в personnel_object_link или position в flight_info
4.	Также можно брать всех сотрудников без должностей с последними табельниками (сейчас это номера 129500+, но меньше 300000)
2.1.1. Пример
1.	Найти незакрытые инциденты по метке "должности" и выписать табельники из них для обновления 
1.	CREW-25103 - Получение подробных данных проблемы... СТАТУС 
http://jira.cn-innov.ru/browse/CREW-25103 Отсутствие интеграции данных 
1.	Должны быть ИБП: 
1.	98906
2.	108365
3.	103575
4.	92515
5.	111180
6.	46909
7.	47141
8.	49000
2.	CREW-26573 - Получение подробных данных проблемы... СТАТУС 
http://jira.cn-innov.ru/browse/CREW-26573 "Ошибка получения данных по бортпроводнику"
1.	Нет в ПГ (Нет должности, возраста): 
1.	129228 Харитонова Марина
2.	129542 Федосюк Мария
3.	129229 Ширина Анна
4.	129113 Дроздова Анастасия
5.	129227 Северюхина Ульяна
6.	129540 Ковтун Юли
7.	129594
3.	CREW-26619 - Получение подробных данных проблемы... СТАТУС 
http://jira.cn-innov.ru/browse/CREW-26619 В персональной карточке не указана ДОЛЖНОСТЬ
1.	Нет в ПГ (Нет должности, возраста) 
1.	123851 Штапову Анну Андреевну 
4.	CREW-26989 - Получение подробных данных проблемы... СТАТУС 
http://jira.cn-innov.ru/browse/CREW-26989 Ошибка в отображении должности
1.	Неправильная должность: 
1.	85111
2.	101446
3.	103144
4.	108365
5.	CREW-28060 - Получение подробных данных проблемы... СТАТУС 
http://jira.cn-innov.ru/browse/CREW-28060 Назначение в резерв недействующих ЧКЭ 
1.	Нет в ПГ (Нет должности, возраста) 
1.	129435
2.	129423
2.	Найти список табельников с изменением должностей за последние 50 дней (для корректной работы нужен актуальный дамп аккорда) 
1.	Запрос для firebird 192.168.1.62:1050 
Запрос для Аккорда----у кого были переводы в другие должности/подразделения за последние 50 дней 
----Запрос для Аккорда----у кого были переводы в другие должности/подразделения за последние 50 дней
select DISTINCT pm.SAP_TAB, pm.FIO, pm.ID_PERS, pmh.dat_b, pmh.dat_e, pmh.DOLGN_STR, pmh.PODRAZ_STR, pm.fd_cc 
from PERS_MAIN_HIST pmh 
JOIN (SELECT * FROM PERS_MAIN pm WHERE 1=1 
--SAP_TAB IN (14502)  --Только определённые БП
--AND fd_cc = 1  ---Только БП
) pm ON pmh.ID_PERS = pm.ID_PERS 
JOIN (SELECT ID_PERS FROM PERS_MAIN_HIST WHERE 
    DAT_E > CAST((CURRENT_TIMESTAMP - 50) AS DATE)  --50 дней
    OR DAT_B > CAST((CURRENT_TIMESTAMP - 50) AS DATE)  --50 дней
) pmh2 ON pmh2.ID_PERS = pmh.ID_PERS
WHERE 1=1
    AND pm.SAP_TAB < 300000
    AND pmh.DAT_E IS null
ORDER BY pm.SAP_TAB, pmh.DAT_B;
----Запрос для Аккорда----у кого были переводы в другие должности/подразделения за последние 50 дней

1.	Полученный список: 
1.	Нажать ctrl+shift-c на столбце с SAP_TAB
 
2.	11603,14227,14238,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,47725,48293,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,86987,87229,88134,90046,90141,90186,90206,90309,92212,92213,92370,92491,92663,93110,93192,93402,93628,93665,93760,94311,94349,95451,95690,95954,96110,96287,97087,97121,97764,98090,98613,99166,100224,100270,101446,101922,102086,102167,102534,102897,103109,103214,103683,104905,104963,105420,106171,106403,108092,108280,109000,110612,111000,111436,111623,111828,112171,112182,116282,116289,118140,118152,118178,118179,118243,121053,121230,121537,121567,121644,121835,121840,122271,122299,122399,123800,123835,123879,123912,123950,124284,124488,125623,125638,125878,126205,126266,126424,126677,127033,127197,127350,127383,127404,127459,127606,127805,127923,127953,128023,128060,128196,128745,129052,129104,129125,129128,129180,129216,129223,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129564,129666,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706
3.	Все работающие сотрудники без должностей или у которых должность в title_dep_summary не совпадает с должностью в personnel_object_link или position в flight_info 
1.	Запрос для ms-personnel (выполнять, конечно же, на ПРОДе)
Запрос для Персонала у кого нет или потенциально неправильная должность среди Пилотов и БП 
----Запрос для Персонала-------
select e.employee_number, e.surname||' '||e.name||' '||e.patronymic fio 
    , tds.title, tds.title_id, fi."position", pol.obj_id1 
    , tds.department, tds.department_id
    , fi.base_airport 
from personnel_v2.employee e 
left join personnel_v2.title_dep_summary tds on tds.employee_number = e.employee_number
left join personnel_v2.flight_info fi on fi.employee_number = e.employee_number 
left join personnel_v2.personnel_object_link pol on pol.type = 'A008' and pol.expired=false and pol.obj_id2 = LPAD(e.employee_number::text,8,'0')
where 1=1 
--    and e."type" = 2  --только БП 
    and e."type" in (1,2)  --только БП и пилоты
    and e.status = 1  --только работающие
    and e.employee_number < 300000
and (tds.id is null or (tds.title_id != fi."position" and fi.position != '99999999') or tds.title_id != pol.obj_id1) 
order by e.employee_number;
----Запрос для Персонала-------

1.	Полученный список: 
1.	3488,3488,5702,11603,12456,15186,44494,46610,85560,87738,87738,92262,94740,94947,96579,96579,97814,98286,98757,99568,102248,102257,102271,102450,102472,102587,102591,102626,102627,102628,102634,102691,102719,102775,102796,102798,102807,102809,102854,103034,103079,103112,103121,103228,103252,103321,103508,103533,103685,103750,104245,104277,104285,104298,104401,104420,104584,104642,104650,104676,104688,104707,104807,104812,104885,104901,104916,104925,104926,104975,105043,105102,105163,105205,105212,105224,105320,105327,105329,105333,105412,105488,105521,105540,105633,105648,105669,105671,105698,105699,105882,105893,105908,105933,105940,105949,105953,106010,106077,106084,106096,106175,106293,106297,106428,106479,106508,106523,106526,106572,106581,106601,106666,106677,106678,107639,107803,107818,107836,107845,107848,107888,107896,107934,107961,108021,108036,108071,108091,108093,108094,108110,108181,108238,108265,108309,108351,108355,108365,108374,108469,108472,108476,108477,108492,108571,108573,108626,108631,108700,108743,108746,108893,108897,108902,108973,108976,108980,109065,109470,109479,109513,109690,109784,109934,110092,110185,110194,110220,110255,110358,110438,110470,110580,110610,110891,110902,110920,110921,110928,110958,110962,110999,111001,111182,111187,111227,111242,111379,111514,111552,111585,111589,111935,111959,111999,112094,112100,112135,112640,115940,116038,116346,116399,116524,116561,116571,116577,116582,116604,116616,116619,116625,116640,116642,116646,116650,116656,116659,116662,116704,116725,116742,116746,116748,116752,116753,116766,116783,116785,116788,116791,116799,116824,116825,116826,116831,116835,116838,116842,116844,116846,116847,116852,116858,116896,116897,116900,116905,116908,116909,116921,116923,116933,116937,116949,116950,116960,116977,116984,116985,116996,117001,117002,117006,117012,117039,117043,117053,117054,117062,117063,117066,117070,117071,117073,117074,117075,117076,117077,117080,117083,117084,117089,117093,117113,117129,117130,117132,117134,117135,117138,117140,117143,117148,117149,117151,117152,117153,117154,117155,117249,117253,117255,117262,117266,117267,117270,117271,117314,117317,117327,117333,117338,117345,117361,117362,117415,117416,117417,117419,117422,117425,117427,117431,117432,117435,117436,117439,117441,117460,117462,117463,117465,117466,117468,117470,117487,117488,117489,117490,117494,117496,117497,117499,117682,117685,118103,118104,118105,118133,118151,118160,118165,118178,118179,118204,118361,121248,121337,121362,121362,121421,121550,121835,121840,121853,121855,122417,122508,123691,124076,124949,126002,126002,127263,127739,128246,128456,128503,128508,128515,128535,128570,128596,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129049,129125,129180,129206,129423,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129767,129779,129783,129784,129787
4.	Собрать все полученнные табельники в один список, чтобы не было повторений 
1.	Запрос со сборкой и сортировкой из предыдущих пунктов 
Запрос для сборки и сортировки табельников для обновления 
select distinct --удаление дубликатов
    * from unnest(array[
    --из инцидентов
    98906,108365,103575,92515,111180,46909,47141,49000,129228,129542,129229,129113,129227,129540,129594,123851,85111,101446,103144,108365,129435,129423
    , --из Аккорда
    11603,14227,14238,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,47725,48293,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,86987,87229,88134,90046,90141,90186,90206,90309,92212,92213,92370,92491,92663,93110,93192,93402,93628,93665,93760,94311,94349,95451,95690,95954,96110,96287,97087,97121,97764,98090,98613,99166,100224,100270,101446,101922,102086,102167,102534,102897,103109,103214,103683,104905,104963,105420,106171,106403,108092,108280,109000,110612,111000,111436,111623,111828,112171,112182,116282,116289,118140,118152,118178,118179,118243,121053,121230,121537,121567,121644,121835,121840,122271,122299,122399,123800,123835,123879,123912,123950,124284,124488,125623,125638,125878,126205,126266,126424,126677,127033,127197,127350,127383,127404,127459,127606,127805,127923,127953,128023,128060,128196,128745,129052,129104,129125,129128,129180,129216,129223,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129564,129666,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706
    , --из персонала
    3488,3488,5702,11603,12456,15186,44494,46610,85560,87738,87738,92262,94740,94947,96579,96579,97814,98286,98757,99568,102248,102257,102271,102450,102472,102587,102591,102626,102627,102628,102634,102691,102719,102775,102796,102798,102807,102809,102854,103034,103079,103112,103121,103228,103252,103321,103508,103533,103685,103750,104245,104277,104285,104298,104401,104420,104584,104642,104650,104676,104688,104707,104807,104812,104885,104901,104916,104925,104926,104975,105043,105102,105163,105205,105212,105224,105320,105327,105329,105333,105412,105488,105521,105540,105633,105648,105669,105671,105698,105699,105882,105893,105908,105933,105940,105949,105953,106010,106077,106084,106096,106175,106293,106297,106428,106479,106508,106523,106526,106572,106581,106601,106666,106677,106678,107639,107803,107818,107836,107845,107848,107888,107896,107934,107961,108021,108036,108071,108091,108093,108094,108110,108181,108238,108265,108309,108351,108355,108365,108374,108469,108472,108476,108477,108492,108571,108573,108626,108631,108700,108743,108746,108893,108897,108902,108973,108976,108980,109065,109470,109479,109513,109690,109784,109934,110092,110185,110194,110220,110255,110358,110438,110470,110580,110610,110891,110902,110920,110921,110928,110958,110962,110999,111001,111182,111187,111227,111242,111379,111514,111552,111585,111589,111935,111959,111999,112094,112100,112135,112640,115940,116038,116346,116399,116524,116561,116571,116577,116582,116604,116616,116619,116625,116640,116642,116646,116650,116656,116659,116662,116704,116725,116742,116746,116748,116752,116753,116766,116783,116785,116788,116791,116799,116824,116825,116826,116831,116835,116838,116842,116844,116846,116847,116852,116858,116896,116897,116900,116905,116908,116909,116921,116923,116933,116937,116949,116950,116960,116977,116984,116985,116996,117001,117002,117006,117012,117039,117043,117053,117054,117062,117063,117066,117070,117071,117073,117074,117075,117076,117077,117080,117083,117084,117089,117093,117113,117129,117130,117132,117134,117135,117138,117140,117143,117148,117149,117151,117152,117153,117154,117155,117249,117253,117255,117262,117266,117267,117270,117271,117314,117317,117327,117333,117338,117345,117361,117362,117415,117416,117417,117419,117422,117425,117427,117431,117432,117435,117436,117439,117441,117460,117462,117463,117465,117466,117468,117470,117487,117488,117489,117490,117494,117496,117497,117499,117682,117685,118103,118104,118105,118133,118151,118160,118165,118178,118179,118204,118361,121248,121337,121362,121362,121421,121550,121835,121840,121853,121855,122417,122508,123691,124076,124949,126002,126002,127263,127739,128246,128456,128503,128508,128515,128535,128570,128596,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129049,129125,129180,129206,129423,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129767,129779,129783,129784,129787
    ]) order by 1; --сортировка
2.	Полученный список табельников: 
1.	3488,5702,11603,12456,14227,14238,15186,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92262,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94740,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98286,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102248,102257,102271,102450,102472,102534,102587,102591,102626,102627,102628,102634,102691,102719,102775,102796,102798,102807,102809,102854,102897,103034,103079,103109,103112,103121,103144,103214,103228,103252,103321,103508,103533,103575,103683,103685,103750,104245,104277,104285,104298,104401,104420,104584,104642,104650,104676,104688,104707,104807,104812,104885,104901,104905,104916,104925,104926,104963,104975,105043,105102,105163,105205,105212,105224,105320,105327,105329,105333,105412,105420,105488,105521,105540,105633,105648,105669,105671,105698,105699,105882,105893,105908,105933,105940,105949,105953,106010,106077,106084,106096,106171,106175,106293,106297,106403,106428,106479,106508,106523,106526,106572,106581,106601,106666,106677,106678,107639,107803,107818,107836,107845,107848,107888,107896,107934,107961,108021,108036,108071,108091,108092,108093,108094,108110,108181,108238,108265,108280,108309,108351,108355,108365,108374,108469,108472,108476,108477,108492,108571,108573,108626,108631,108700,108743,108746,108893,108897,108902,108973,108976,108980,109000,109065,109470,109479,109513,109690,109784,109934,110092,110185,110194,110220,110255,110358,110438,110470,110580,110610,110612,110891,110902,110920,110921,110928,110958,110962,110999,111000,111001,111180,111182,111187,111227,111242,111379,111436,111514,111552,111585,111589,111623,111828,111935,111959,111999,112094,112100,112135,112171,112182,112640,115940,116038,116282,116289,116346,116399,116524,116561,116571,116577,116582,116604,116616,116619,116625,116640,116642,116646,116650,116656,116659,116662,116704,116725,116742,116746,116748,116752,116753,116766,116783,116785,116788,116791,116799,116824,116825,116826,116831,116835,116838,116842,116844,116846,116847,116852,116858,116896,116897,116900,116905,116908,116909,116921,116923,116933,116937,116949,116950,116960,116977,116984,116985,116996,117001,117002,117006,117012,117039,117043,117053,117054,117062,117063,117066,117070,117071,117073,117074,117075,117076,117077,117080,117083,117084,117089,117093,117113,117129,117130,117132,117134,117135,117138,117140,117143,117148,117149,117151,117152,117153,117154,117155,117249,117253,117255,117262,117266,117267,117270,117271,117314,117317,117327,117333,117338,117345,117361,117362,117415,117416,117417,117419,117422,117425,117427,117431,117432,117435,117436,117439,117441,117460,117462,117463,117465,117466,117468,117470,117487,117488,117489,117490,117494,117496,117497,117499,117682,117685,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121248,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122417,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,124949,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129049,129052,129104,129113,129125,129128,129180,129206,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129666,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787

2.2. Подготовка данных для получения данных из САП
2.2.1. Совсем вручную
Всегда есть вариант по каждому табельнику копаться в adp-sap в сырых сообщениях и выискивать нужную телеграмму и готовить скрипты обновления по инструкции SAP. Применение в ms-personnel.
В этом случае никакая подготовка не нужна, но и инструкции как копаться в данных я не дам. Просто делайте всё как нужно по алгоритму обработчика САП :slight_smile: 
2.2.2. Полуавтомат с парсером пока adp-sap на тесте не работает
Дима Тарасов в своё время написал парсер, который из сырых сообщений делает плоскую таблицу. Этот парсер работает только на тест-стенде, но на тест-стенд не подключено чтение из очередей, поэтому надо перетаскивать сообщения с других стендов. Например, с дев или прод. 
Алгоритм:
1.	Определить jms_id последнего сообщения в адаптере на тест стенде
Определить jms_id последнего сообщения в адаптере на тест стенде 
select jms_id, * from a_hrmd_out_crewcn_06 order by id desc limit 1;  --414d5120514d41464c50524f4420202069772ad827d962fa
2.	Запросить новые сообщения в адаптере на дев стенде (подставить jms_id с тест-стенда)
новые сообщения в адаптере на дев стенде 
select 
--    id, 
    jms_id, trace_id, 'NEW' status, "version", create_date, sent_from_ibm_date, payload, headers from a_hrmd_out_crewcn_01 
where id>(select id from public.a_hrmd_out_crewcn_01 ashoc where jms_id = '414d5120514d41464c50524f4420202069772ad827d962fa')
order by id;
3.	Выгрузить новые сообщения как SQL INSERT
4.	Вставить новые сообщение в адаптер на тест-стенде
5.	Запустить парсер по инструкции 
1.	Файлы:
1.	Парсер XmlToDbProcessor-1.0.0-20250603102613-all.jar
2.	Инструкция readme.txt
2.	Пример лога выполнения работы парсера
parser log 
PS C:\Users\user\Downloads\CREW\SAP\ParserTest> java -jar .\XmlToDbProcessor-1.0.0-20250603102613-all.jar
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
processed batch 0 from 139 left:136
processed batch 2 from 139 left:138
processed batch 3 from 139 left:137
processed batch 1 from 139 left:135
processed batch 5 from 139 left:134
processed batch 4 from 139 left:133
processed batch 6 from 139 left:132
processed batch 7 from 139 left:131
processed batch 8 from 139 left:130
processed batch 10 from 139 left:129
processed batch 9 from 139 left:128
processed batch 11 from 139 left:127
processed batch 12 from 139 left:126
processed batch 13 from 139 left:125
processed batch 14 from 139 left:124
processed batch 15 from 139 left:123
processed batch 17 from 139 left:122
processed batch 16 from 139 left:121
processed batch 19 from 139 left:120
processed batch 18 from 139 left:119
processed batch 22 from 139 left:118
processed batch 20 from 139 left:117
processed batch 21 from 139 left:116
processed batch 23 from 139 left:115
processed batch 26 from 139 left:114
processed batch 24 from 139 left:113
processed batch 25 from 139 left:112
processed batch 27 from 139 left:111
processed batch 28 from 139 left:110
processed batch 31 from 139 left:109
processed batch 29 from 139 left:108
processed batch 30 from 139 left:107
processed batch 33 from 139 left:106
processed batch 34 from 139 left:105
processed batch 32 from 139 left:104
processed batch 35 from 139 left:103
processed batch 36 from 139 left:102
processed batch 37 from 139 left:101
processed batch 38 from 139 left:100
processed batch 39 from 139 left:99
processed batch 40 from 139 left:98
processed batch 41 from 139 left:97
processed batch 43 from 139 left:96
processed batch 42 from 139 left:95
processed batch 44 from 139 left:94
processed batch 46 from 139 left:93
processed batch 45 from 139 left:92
processed batch 47 from 139 left:91
processed batch 48 from 139 left:90
processed batch 51 from 139 left:89
processed batch 50 from 139 left:88
processed batch 49 from 139 left:87
processed batch 52 from 139 left:86
processed batch 53 from 139 left:85
processed batch 55 from 139 left:84
processed batch 56 from 139 left:83
processed batch 54 from 139 left:82
processed batch 57 from 139 left:81
processed batch 58 from 139 left:80
processed batch 59 from 139 left:79
processed batch 60 from 139 left:78
processed batch 63 from 139 left:77
processed batch 61 from 139 left:76
processed batch 62 from 139 left:75
processed batch 64 from 139 left:74
processed batch 66 from 139 left:73
processed batch 65 from 139 left:72
processed batch 68 from 139 left:71
processed batch 67 from 139 left:70
processed batch 71 from 139 left:69
processed batch 70 from 139 left:68
processed batch 72 from 139 left:67
processed batch 69 from 139 left:66
processed batch 74 from 139 left:65
processed batch 76 from 139 left:64
processed batch 73 from 139 left:63
processed batch 75 from 139 left:62
processed batch 77 from 139 left:61
processed batch 80 from 139 left:60
processed batch 78 from 139 left:59
processed batch 81 from 139 left:58
processed batch 79 from 139 left:57
processed batch 83 from 139 left:56
processed batch 85 from 139 left:55
processed batch 82 from 139 left:54
processed batch 84 from 139 left:53
processed batch 86 from 139 left:52
processed batch 89 from 139 left:51
processed batch 87 from 139 left:50
processed batch 88 from 139 left:49
processed batch 91 from 139 left:48
processed batch 92 from 139 left:47
processed batch 90 from 139 left:46
processed batch 93 from 139 left:45
processed batch 97 from 139 left:44
processed batch 95 from 139 left:43
processed batch 94 from 139 left:42
processed batch 96 from 139 left:41
processed batch 98 from 139 left:40
processed batch 100 from 139 left:39
processed batch 99 from 139 left:38
processed batch 101 from 139 left:37
processed batch 102 from 139 left:36
processed batch 103 from 139 left:35
processed batch 104 from 139 left:34
processed batch 105 from 139 left:33
processed batch 106 from 139 left:32
processed batch 107 from 139 left:31
processed batch 109 from 139 left:30
processed batch 108 from 139 left:29
processed batch 110 from 139 left:28
processed batch 111 from 139 left:27
processed batch 112 from 139 left:26
processed batch 113 from 139 left:25
processed batch 114 from 139 left:24
processed batch 115 from 139 left:23
processed batch 116 from 139 left:22
processed batch 117 from 139 left:21
processed batch 119 from 139 left:20
processed batch 118 from 139 left:19
processed batch 120 from 139 left:18
processed batch 121 from 139 left:17
processed batch 124 from 139 left:16
processed batch 122 from 139 left:15
Processed 2 101 records
processed batch 123 from 139 left:14
processed batch 128 from 139 left:13
processed batch 125 from 139 left:12
processed batch 130 from 139 left:11
processed batch 131 from 139 left:10
processed batch 132 from 139 left:9
processed batch 126 from 139 left:8
processed batch 127 from 139 left:7
processed batch 135 from 139 left:6
processed batch 134 from 139 left:5
processed batch 137 from 139 left:4
processed batch 138 from 139 left:3
processed batch 133 from 139 left:2
processed batch 129 from 139 left:1
processed batch 136 from 139 left:0
PS C:\Users\user\Downloads\CREW\SAP\ParserTest>


2.2.3. Полуавтомат с парсером когда adp-sap на тесте будет работать
1.	Запустить парсер по инструкции 
1.	Файлы:
1.	Парсер XmlToDbProcessor-1.0.0-20250603102613-all.jar
2.	Инструкция readme.txt
2.	Пример лога выполнения работы парсера
parser log 
PS C:\Users\user\Downloads\CREW\SAP\ParserTest> java -jar .\XmlToDbProcessor-1.0.0-20250603102613-all.jar
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
processed batch 0 from 139 left:136
processed batch 2 from 139 left:138
processed batch 3 from 139 left:137
processed batch 1 from 139 left:135
processed batch 5 from 139 left:134
processed batch 4 from 139 left:133
processed batch 6 from 139 left:132
processed batch 7 from 139 left:131
processed batch 8 from 139 left:130
processed batch 10 from 139 left:129
processed batch 9 from 139 left:128
processed batch 11 from 139 left:127
processed batch 12 from 139 left:126
processed batch 13 from 139 left:125
processed batch 14 from 139 left:124
processed batch 15 from 139 left:123
processed batch 17 from 139 left:122
processed batch 16 from 139 left:121
processed batch 19 from 139 left:120
processed batch 18 from 139 left:119
processed batch 22 from 139 left:118
processed batch 20 from 139 left:117
processed batch 21 from 139 left:116
processed batch 23 from 139 left:115
processed batch 26 from 139 left:114
processed batch 24 from 139 left:113
processed batch 25 from 139 left:112
processed batch 27 from 139 left:111
processed batch 28 from 139 left:110
processed batch 31 from 139 left:109
processed batch 29 from 139 left:108
processed batch 30 from 139 left:107
processed batch 33 from 139 left:106
processed batch 34 from 139 left:105
processed batch 32 from 139 left:104
processed batch 35 from 139 left:103
processed batch 36 from 139 left:102
processed batch 37 from 139 left:101
processed batch 38 from 139 left:100
processed batch 39 from 139 left:99
processed batch 40 from 139 left:98
processed batch 41 from 139 left:97
processed batch 43 from 139 left:96
processed batch 42 from 139 left:95
processed batch 44 from 139 left:94
processed batch 46 from 139 left:93
processed batch 45 from 139 left:92
processed batch 47 from 139 left:91
processed batch 48 from 139 left:90
processed batch 51 from 139 left:89
processed batch 50 from 139 left:88
processed batch 49 from 139 left:87
processed batch 52 from 139 left:86
processed batch 53 from 139 left:85
processed batch 55 from 139 left:84
processed batch 56 from 139 left:83
processed batch 54 from 139 left:82
processed batch 57 from 139 left:81
processed batch 58 from 139 left:80
processed batch 59 from 139 left:79
processed batch 60 from 139 left:78
processed batch 63 from 139 left:77
processed batch 61 from 139 left:76
processed batch 62 from 139 left:75
processed batch 64 from 139 left:74
processed batch 66 from 139 left:73
processed batch 65 from 139 left:72
processed batch 68 from 139 left:71
processed batch 67 from 139 left:70
processed batch 71 from 139 left:69
processed batch 70 from 139 left:68
processed batch 72 from 139 left:67
processed batch 69 from 139 left:66
processed batch 74 from 139 left:65
processed batch 76 from 139 left:64
processed batch 73 from 139 left:63
processed batch 75 from 139 left:62
processed batch 77 from 139 left:61
processed batch 80 from 139 left:60
processed batch 78 from 139 left:59
processed batch 81 from 139 left:58
processed batch 79 from 139 left:57
processed batch 83 from 139 left:56
processed batch 85 from 139 left:55
processed batch 82 from 139 left:54
processed batch 84 from 139 left:53
processed batch 86 from 139 left:52
processed batch 89 from 139 left:51
processed batch 87 from 139 left:50
processed batch 88 from 139 left:49
processed batch 91 from 139 left:48
processed batch 92 from 139 left:47
processed batch 90 from 139 left:46
processed batch 93 from 139 left:45
processed batch 97 from 139 left:44
processed batch 95 from 139 left:43
processed batch 94 from 139 left:42
processed batch 96 from 139 left:41
processed batch 98 from 139 left:40
processed batch 100 from 139 left:39
processed batch 99 from 139 left:38
processed batch 101 from 139 left:37
processed batch 102 from 139 left:36
processed batch 103 from 139 left:35
processed batch 104 from 139 left:34
processed batch 105 from 139 left:33
processed batch 106 from 139 left:32
processed batch 107 from 139 left:31
processed batch 109 from 139 left:30
processed batch 108 from 139 left:29
processed batch 110 from 139 left:28
processed batch 111 from 139 left:27
processed batch 112 from 139 left:26
processed batch 113 from 139 left:25
processed batch 114 from 139 left:24
processed batch 115 from 139 left:23
processed batch 116 from 139 left:22
processed batch 117 from 139 left:21
processed batch 119 from 139 left:20
processed batch 118 from 139 left:19
processed batch 120 from 139 left:18
processed batch 121 from 139 left:17
processed batch 124 from 139 left:16
processed batch 122 from 139 left:15
Processed 2 101 records
processed batch 123 from 139 left:14
processed batch 128 from 139 left:13
processed batch 125 from 139 left:12
processed batch 130 from 139 left:11
processed batch 131 from 139 left:10
processed batch 132 from 139 left:9
processed batch 126 from 139 left:8
processed batch 127 from 139 left:7
processed batch 135 from 139 left:6
processed batch 134 from 139 left:5
processed batch 137 from 139 left:4
processed batch 138 from 139 left:3
processed batch 133 from 139 left:2
processed batch 129 from 139 left:1
processed batch 136 from 139 left:0
PS C:\Users\user\Downloads\CREW\SAP\ParserTest>
2.3. Основной запрос, которым можно проверять актуальность данных
Основной запрос для проверки данных 
----Запрос для Персонала по title_dep_summary и personnel_object_link-------
select 
--        tds.title_id, tds.title, en, pol.expired, pol.obj_id1  --для сравнения должностей в excel
    en
    , e.surname||' '||e.name||' '||e.patronymic fio 
    , e.type T --тип (1- пилот, 2-БП, 0-неизв)
    , e.status S --статус (1-работает, 2-не работает)
    , e.citizenship C --гражданство. Если UN - значит нет данных
    , e.birth_date d_birth
    , (tds.title_id = pol.obj_id1) is_title_id_actual   --Совпадает ли должность в title_dep_summary и personnel_object_link. Если false - значит значение неактуальное
    , tds.title, tds.department, tds.title_id 
    , pol.obj_id1
    , pol.expired --устарела ли запись в personnel_object_link
    , fi.base_airport --Код базового аэропорта. Если 140 - значит это дефолт из Аккорда, и запись надо обновить
    , fi.position  --должность в flight-info. Обычно если 9999999- вероятно, что сотрудник уволен
    , a.start_date --начало периода доступности
    , a.end_date  --конец периода доступности
    , a.available  --доступнен ли для планирования
    , com_t.value telephone --телефон
    , com_e.value email  --emailы
    , ips.international_passport_json  --загранники
    , jp.pass_json  --пропуски
    , jdpi.dep_position_info_json  --история назначений в department_position_info. Если пусто, значит надо заполнить должности и обновить
FROM UNNEST(ARRAY[
    --сюда подставить список табельников, которые надо проверить
    3488,5702,11603,12456,14227,14238,15186,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92262,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94740,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98286,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102248,102257,102271,102450,102472,102534,102587,102591,102626,102627,102628,102634,102691,102719,102775,102796,102798,102807,102809,102854,102897,103034,103079,103109,103112,103121,103144,103214,103228,103252,103321,103508,103533,103575,103683,103685,103750,104245,104277,104285,104298,104401,104420,104584,104642,104650,104676,104688,104707,104807,104812,104885,104901,104905,104916,104925,104926,104963,104975,105043,105102,105163,105205,105212,105224,105320,105327,105329,105333,105412,105420,105488,105521,105540,105633,105648,105669,105671,105698,105699,105882,105893,105908,105933,105940,105949,105953,106010,106077,106084,106096,106171,106175,106293,106297,106403,106428,106479,106508,106523,106526,106572,106581,106601,106666,106677,106678,107639,107803,107818,107836,107845,107848,107888,107896,107934,107961,108021,108036,108071,108091,108092,108093,108094,108110,108181,108238,108265,108280,108309,108351,108355,108365,108374,108469,108472,108476,108477,108492,108571,108573,108626,108631,108700,108743,108746,108893,108897,108902,108973,108976,108980,109000,109065,109470,109479,109513,109690,109784,109934,110092,110185,110194,110220,110255,110358,110438,110470,110580,110610,110612,110891,110902,110920,110921,110928,110958,110962,110999,111000,111001,111180,111182,111187,111227,111242,111379,111436,111514,111552,111585,111589,111623,111828,111935,111959,111999,112094,112100,112135,112171,112182,112640,115940,116038,116282,116289,116346,116399,116524,116561,116571,116577,116582,116604,116616,116619,116625,116640,116642,116646,116650,116656,116659,116662,116704,116725,116742,116746,116748,116752,116753,116766,116783,116785,116788,116791,116799,116824,116825,116826,116831,116835,116838,116842,116844,116846,116847,116852,116858,116896,116897,116900,116905,116908,116909,116921,116923,116933,116937,116949,116950,116960,116977,116984,116985,116996,117001,117002,117006,117012,117039,117043,117053,117054,117062,117063,117066,117070,117071,117073,117074,117075,117076,117077,117080,117083,117084,117089,117093,117113,117129,117130,117132,117134,117135,117138,117140,117143,117148,117149,117151,117152,117153,117154,117155,117249,117253,117255,117262,117266,117267,117270,117271,117314,117317,117327,117333,117338,117345,117361,117362,117415,117416,117417,117419,117422,117425,117427,117431,117432,117435,117436,117439,117441,117460,117462,117463,117465,117466,117468,117470,117487,117488,117489,117490,117494,117496,117497,117499,117682,117685,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121248,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122417,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,124949,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129049,129052,129104,129113,129125,129128,129180,129206,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129666,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
]) AS en
left join personnel_v2.employee e on e.employee_number = en
left join personnel_v2.flight_info fi on fi.employee_number = en and fi.expired = false
left join personnel_v2.availability a on a.employee_number = en and a.end_date = '9999-01-01'
left join personnel_v2.communication com_t on com_t.employee_number = en and com_t."type" = 18 /*номер телефона*/ and com_t.expired = false
left join personnel_v2.communication com_e on com_e.employee_number = en and com_e."type" = 29 /*email*/ and com_e.expired = false
left join personnel_v2.title_dep_summary tds on tds.employee_number = e.employee_number 
left join personnel_v2.personnel_object_link pol on pol.type = 'A008' 
    and pol.expired=false --только актуальные записи в personnel_object_link. Закомментировать для сравнения должностей в excel
    and pol.obj_id2 = LPAD(e.employee_number::text,8,'0')
left join (select j.employee_number, json_agg(j.*) international_passport_json from 
    (select ip.id, ip.employee_number, ip.emp_name, ip.emp_surname, ip.series, ip."number", ip.availability_status availability_status_id, ips."name" availability_status, ip.not_available_date, ip.issued_by, ip.issue_date, ip.expiration_date, ip.expired, ip."source", ip.emp_patronymic, ip.birth_place, ip.birth_place_eng, ip.mcl_usa, ip."comment", ip.seqnr, ip.issued_by_eng 
    from personnel_v2.international_passport ip left join personnel_v2.international_passport_status ips on ips.id = ip.availability_status 
    where 1 = 1 and ip.expiration_date > now()) j group by j.employee_number
    ) ips on ips.employee_number = e.employee_number
left join (select j.employee_number, json_agg(j.*) pass_json from 
    (select p.id, p.employee_number, p.start_date, p.end_date, p.pass_id, p.type type_id, pt."name" type, p.status status_id, ps.name status, p.stop_date, p.reff_id, p."source", p."name", p.surname
    from personnel_v2.pass p left join personnel_v2.pass_status ps on ps.id = p.status left join personnel_v2.pass_type pt on pt.id = p."type" 
    where 1=1 and p.end_date > now()) j group by j.employee_number
    ) jp on jp.employee_number = e.employee_number
left join (SELECT j.employee_number, json_agg(row_to_json(j) ORDER BY j.date_start ASC) AS dep_position_info_json 
    FROM (SELECT dpi.id, dpi.employee_number, dpi.department_name, dpi.position_name, dpi.date_start, dpi.date_end, dpi.is_deleted, dpi.employee_position_type 
    FROM personnel_v2.department_position_info dpi) j GROUP BY j.employee_number
    ) jdpi on jdpi.employee_number = e.employee_number
where 1=1
--and e."type" = 2 and e.status = 1  --только работающие БП
order by en
--    e.employee_number
;
----Запрос для Персонала по title_dep_summary и personnel_object_link------

2.4. Обновление данных по данным из САП в employee
2.4.1. Сгененировать обновление для таблицы employee (ФИО, возраст, гражданство)
employee  
--employee
--Обновить employee для   
select * from (
select ids
    , row_number() over (partition by ids ORDER BY creationtime desc) id_rn  
--    , 'UPDATE personnel_v2.employee SET "type"=2, "name"='''||phl.vorna||''', patronymic='''||phl.nach2||''', surname='''||phl.nachn||''', initials='''||phl.inits||''', sex='''||case when gesch = '2' then 'F' else 'M' end||''', birth_date='''||to_date(phl.gbdat, 'YYYYMMDD')||''', citizenship='''||phl.natio||''', marital_status='||coalesce(phl.FAMST, '1')::int||', marital_status_date='||coalesce(case when phl.famdt='00000000' then null else to_char(to_date(phl.famdt, 'YYYYMMDD'),'''YYYY-MM-DD''') end, 'null')||', update_user=''SYSTEM'', update_date=now(), status=1, expired=false WHERE employee_number='||phl.pernr||';' sql_update_type_2
    , 'UPDATE personnel_v2.employee SET "name"='''||phl.vorna||''', patronymic='''||coalesce(phl.nach2,'')||''', surname='''||phl.nachn||''', initials='''||phl.inits||''', sex='''||case when gesch = '2' then 'F' else 'M' end||''', birth_date='''||to_date(phl.gbdat, 'YYYYMMDD')||''', citizenship='''||phl.natio||''', marital_status='||coalesce(phl.FAMST, '1')::int||', marital_status_date='||coalesce(case when phl.famdt='00000000' then null else to_char(to_date(phl.famdt, 'YYYYMMDD'),'''YYYY-MM-DD''') end, 'null')||', update_user=''SYSTEM'', update_date=now(), status=1, expired=false WHERE employee_number='||phl.pernr||';' sql_update_no_type
--    , 'INSERT INTO personnel_v2.employee (employee_number, "type", "name", patronymic, surname, initials, sex, birth_date, citizenship, marital_status, marital_status_date, create_user, create_date, update_user, update_date, status, expired, akk_pers_main_id, akk_pers_public_id) VALUES('||phl.pernr||', 2, '''||phl.vorna||''', '''||coalesce(phl.nach2,'')||''', '''||phl.nachn||''', '''||phl.inits||''', '''||case when gesch = '2' then 'F' else 'M' end||''', '''||to_date(phl.gbdat, 'YYYYMMDD')||''', '''||phl.natio||''', '||coalesce(phl.FAMST, '1')::int||', '||coalesce(case when phl.famdt='00000000' then null else to_char(to_date(phl.famdt, 'YYYYMMDD'),'''YYYY-MM-DD''') end, 'null')||', ''HF_0000'', now(), ''HF_0000'', now(), 1, false, null, null); ' sql_insert
    , id, anzkd, begda, endda, FAMST, famdt, gbdat, gesch, inits, nach2, nachn, natio, opera, pernr, seqnr, vorna, zzl_nach2_dat, zzl_nach2_rod, zzl_nachn_dat, zzl_nachn_rod, zzl_vorna_dat, zzl_vorna_rod, create_date, created_by, creationtime, idocnum, p_code, raw_message_id
from unnest(array[
    3488,5702,11603,12456,14227,14238,15186,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92262,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94740,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98286,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102248,102257,102271,102450,102472,102534,102587,102591,102626,102627,102628,102634,102691,102719,102775,102796,102798,102807,102809,102854,102897,103034,103079,103109,103112,103121,103144,103214,103228,103252,103321,103508,103533,103575,103683,103685,103750,104245,104277,104285,104298,104401,104420,104584,104642,104650,104676,104688,104707,104807,104812,104885,104901,104905,104916,104925,104926,104963,104975,105043,105102,105163,105205,105212,105224,105320,105327,105329,105333,105412,105420,105488,105521,105540,105633,105648,105669,105671,105698,105699,105882,105893,105908,105933,105940,105949,105953,106010,106077,106084,106096,106171,106175,106293,106297,106403,106428,106479,106508,106523,106526,106572,106581,106601,106666,106677,106678,107639,107803,107818,107836,107845,107848,107888,107896,107934,107961,108021,108036,108071,108091,108092,108093,108094,108110,108181,108238,108265,108280,108309,108351,108355,108365,108374,108469,108472,108476,108477,108492,108571,108573,108626,108631,108700,108743,108746,108893,108897,108902,108973,108976,108980,109000,109065,109470,109479,109513,109690,109784,109934,110092,110185,110194,110220,110255,110358,110438,110470,110580,110610,110612,110891,110902,110920,110921,110928,110958,110962,110999,111000,111001,111180,111182,111187,111227,111242,111379,111436,111514,111552,111585,111589,111623,111828,111935,111959,111999,112094,112100,112135,112171,112182,112640,115940,116038,116282,116289,116346,116399,116524,116561,116571,116577,116582,116604,116616,116619,116625,116640,116642,116646,116650,116656,116659,116662,116704,116725,116742,116746,116748,116752,116753,116766,116783,116785,116788,116791,116799,116824,116825,116826,116831,116835,116838,116842,116844,116846,116847,116852,116858,116896,116897,116900,116905,116908,116909,116921,116923,116933,116937,116949,116950,116960,116977,116984,116985,116996,117001,117002,117006,117012,117039,117043,117053,117054,117062,117063,117066,117070,117071,117073,117074,117075,117076,117077,117080,117083,117084,117089,117093,117113,117129,117130,117132,117134,117135,117138,117140,117143,117148,117149,117151,117152,117153,117154,117155,117249,117253,117255,117262,117266,117267,117270,117271,117314,117317,117327,117333,117338,117345,117361,117362,117415,117416,117417,117419,117422,117425,117427,117431,117432,117435,117436,117439,117441,117460,117462,117463,117465,117466,117468,117470,117487,117488,117489,117490,117494,117496,117497,117499,117682,117685,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121248,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122417,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,124949,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129049,129052,129104,129113,129125,129128,129180,129206,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129666,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
    ]) ids
left join parced_hrmd_lines_2 phl 
on phl.p_code = 'P0002'
and phl.pernr = LPAD(ids::text,8,'0')
and phl.endda = '99991231'
) sorted 
where sorted.id_rn = 1
and id is not null
order by 1, creationtime;
2.4.1.1. Пример получившегося скрипта
employee пример 
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Борисович', surname='Василенко', initials='А.Б.', sex='M', birth_date='1960-07-23', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00003488;
UPDATE personnel_v2.employee SET "name"='Юрий', patronymic='Николаевич', surname='Воропаев', initials='Ю.Н.', sex='M', birth_date='1962-03-16', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00005702;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Викторович', surname='Цинбал', initials='А.В.', sex='M', birth_date='1989-08-26', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00011603;
UPDATE personnel_v2.employee SET "name"='Виталий', patronymic='Викторович', surname='Михайлов', initials='В.В.', sex='M', birth_date='1985-11-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00012456;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Вячеславович', surname='Дойников', initials='А.В.', sex='M', birth_date='1979-10-22', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00014227;
UPDATE personnel_v2.employee SET "name"='Людмила', patronymic='Александровна', surname='Тишакова', initials='Л.А.', sex='F', birth_date='1977-01-19', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00014238;
UPDATE personnel_v2.employee SET "name"='Василий', patronymic='Михайлович', surname='Макошенец', initials='В.М.', sex='M', birth_date='1978-04-19', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00015223;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Владимирович', surname='Малуколов', initials='С.В.', sex='M', birth_date='1977-09-25', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00015306;
UPDATE personnel_v2.employee SET "name"='Елена', patronymic='Викторовна', surname='Инютина', initials='Е.В.', sex='F', birth_date='1970-01-20', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00019015;
UPDATE personnel_v2.employee SET "name"='Татьяна', patronymic='Николаевна', surname='Рапацевич', initials='Т.Н.', sex='F', birth_date='1976-03-21', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00025480;
UPDATE personnel_v2.employee SET "name"='Максим', patronymic='Дмитриевич', surname='Почкаенко', initials='М.Д.', sex='M', birth_date='1984-01-27', citizenship='RU', marital_status=2, marital_status_date='2009-08-12', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00033058;
UPDATE personnel_v2.employee SET "name"='Игорь', patronymic='Вячеславович', surname='Драгунов', initials='И.В.', sex='M', birth_date='1975-02-28', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00033324;
UPDATE personnel_v2.employee SET "name"='Ольга', patronymic='Борисовна', surname='Довбыш', initials='О.Б.', sex='F', birth_date='1975-06-30', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00033340;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Петрович', surname='Сидоров', initials='С.П.', sex='M', birth_date='1972-04-22', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00033358;
UPDATE personnel_v2.employee SET "name"='Вячеслав', patronymic='Александрович', surname='Агафонов', initials='В.А.', sex='M', birth_date='1965-07-12', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00033375;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Геннадьевич', surname='Алмаев', initials='А.Г.', sex='M', birth_date='1968-12-30', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00034202;
UPDATE personnel_v2.employee SET "name"='Светлана', patronymic='Викторовна', surname='Карпенкова', initials='С.В.', sex='F', birth_date='1974-05-16', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00034555;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Александровна', surname='Аносова', initials='Н.А.', sex='F', birth_date='1981-06-16', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00034607;
UPDATE personnel_v2.employee SET "name"='Виктор', patronymic='Михайлович', surname='Трухин', initials='В.М.', sex='M', birth_date='1956-10-09', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00034952;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Сергеевна', surname='Шумильная', initials='Н.С.', sex='F', birth_date='1979-01-19', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00039868;
UPDATE personnel_v2.employee SET "name"='Елена', patronymic='Юрьевна', surname='Волчкова', initials='Е.Ю.', sex='F', birth_date='1976-06-03', citizenship='RU', marital_status=2, marital_status_date='2015-04-17', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00044494;
UPDATE personnel_v2.employee SET "name"='Инна', patronymic='Владимировна', surname='Кузнецова', initials='И.В.', sex='F', birth_date='1987-11-05', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00046610;
UPDATE personnel_v2.employee SET "name"='Елена', patronymic='Геннадьевна', surname='Киреева', initials='Е.Г.', sex='F', birth_date='1975-09-30', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00046909;
UPDATE personnel_v2.employee SET "name"='Марина', patronymic='Юрьевна', surname='Водолазова', initials='М.Ю.', sex='F', birth_date='1970-03-03', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00047141;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Валерьевна', surname='Михальчук', initials='Н.В.', sex='F', birth_date='1975-09-18', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00047725;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Сергеевна', surname='Чернова', initials='Н.С.', sex='F', birth_date='1987-01-20', citizenship='RU', marital_status=2, marital_status_date='2015-09-12', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00048293;
UPDATE personnel_v2.employee SET "name"='Михаил', patronymic='Петрович', surname='Токмаков', initials='М.П.', sex='M', birth_date='1966-09-16', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00049000;
UPDATE personnel_v2.employee SET "name"='Людмила', patronymic='Михайловна', surname='Судьина', initials='Л.М.', sex='F', birth_date='1985-10-25', citizenship='RU', marital_status=2, marital_status_date='2015-08-14', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00054868;
UPDATE personnel_v2.employee SET "name"='Виктор', patronymic='Станиславович', surname='Корыстов', initials='В.С.', sex='M', birth_date='1970-08-25', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00064341;
UPDATE personnel_v2.employee SET "name"='Оксана', patronymic='Николаевна', surname='Спиридонова', initials='О.Н.', sex='F', birth_date='1974-06-17', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00064735;
UPDATE personnel_v2.employee SET "name"='Игорь', patronymic='Сергеевич', surname='Кулагин', initials='И.С.', sex='M', birth_date='1958-08-05', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00065778;
UPDATE personnel_v2.employee SET "name"='Валерий', patronymic='Владимирович', surname='Серых', initials='В.В.', sex='M', birth_date='1974-05-01', citizenship='RU', marital_status=4, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00066063;
UPDATE personnel_v2.employee SET "name"='Елена', patronymic='Константиновна', surname='Сухарева', initials='Е.К.', sex='F', birth_date='1982-06-10', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00066504;
UPDATE personnel_v2.employee SET "name"='Юлия', patronymic='Анатольевна', surname='Позднякова', initials='Ю.А.', sex='F', birth_date='1975-08-28', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00069754;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Русланович', surname='Никитин', initials='А.Р.', sex='M', birth_date='1965-03-10', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00075027;
UPDATE personnel_v2.employee SET "name"='Дмитрий', patronymic='Алексеевич', surname='Зелов', initials='Д.А.', sex='M', birth_date='1988-05-09', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00078514;
UPDATE personnel_v2.employee SET "name"='Максим', patronymic='Александрович', surname='Базалиев', initials='М.А.', sex='M', birth_date='1979-08-30', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00078681;
UPDATE personnel_v2.employee SET "name"='Денис', patronymic='Александрович', surname='Рыков', initials='Д.А.', sex='M', birth_date='1975-06-20', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00078936;
UPDATE personnel_v2.employee SET "name"='Юлия', patronymic='Сергеевна', surname='Горлова', initials='Ю.С.', sex='F', birth_date='1978-05-22', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00081937;
UPDATE personnel_v2.employee SET "name"='Вячеслав', patronymic='Владимирович', surname='Орлов', initials='В.В.', sex='M', birth_date='1989-10-11', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00085064;
UPDATE personnel_v2.employee SET "name"='Светлана', patronymic='Олеговна', surname='Махова', initials='С.О.', sex='F', birth_date='1988-04-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00085111;
UPDATE personnel_v2.employee SET "name"='Геннадий', patronymic='Александрович', surname='Лагодин', initials='Г.А.', sex='M', birth_date='1961-04-17', citizenship='RU', marital_status=2, marital_status_date='1982-05-29', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00085560;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Геральдович', surname='Галигузов', initials='А.Г.', sex='M', birth_date='1965-07-27', citizenship='RU', marital_status=2, marital_status_date='1986-03-29', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00086987;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Юрьевич', surname='Егоров', initials='А.Ю.', sex='M', birth_date='1965-09-10', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00087229;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Владимирович', surname='Аксёнов', initials='А.В.', sex='M', birth_date='1990-02-03', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00087738;
UPDATE personnel_v2.employee SET "name"='Роман', patronymic='Валерьевич', surname='Шайхитдинов', initials='Р.В.', sex='M', birth_date='1979-10-21', citizenship='RU', marital_status=2, marital_status_date='2002-08-09', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00088134;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Юрьевна', surname='Мамедова', initials='Н.Ю.', sex='F', birth_date='1988-06-22', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00090046;
UPDATE personnel_v2.employee SET "name"='Игорь', patronymic='Анатольевич', surname='Левин', initials='И.А.', sex='M', birth_date='1967-03-06', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00090141;
UPDATE personnel_v2.employee SET "name"='Надежда', patronymic='Владимировна', surname='Власова', initials='Н.В.', sex='F', birth_date='1968-09-22', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00090186;
UPDATE personnel_v2.employee SET "name"='Ольга', patronymic='Владимировна', surname='Осичкина', initials='О.В.', sex='F', birth_date='1974-02-10', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00090206;
UPDATE personnel_v2.employee SET "name"='Владимир', patronymic='Юрьевич', surname='Архипов', initials='В.Ю.', sex='M', birth_date='1963-11-19', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00090309;
UPDATE personnel_v2.employee SET "name"='Юлия', patronymic='Сергеевна', surname='Копнина', initials='Ю.С.', sex='F', birth_date='1988-07-26', citizenship='RU', marital_status=2, marital_status_date='2013-02-27', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00092212;
UPDATE personnel_v2.employee SET "name"='Мария', patronymic='Алексеевна', surname='Вербина', initials='М.А.', sex='F', birth_date='1993-03-20', citizenship='RU', marital_status=2, marital_status_date='2019-08-24', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00092213;
UPDATE personnel_v2.employee SET "name"='Николай', patronymic='Владимирович', surname='Адамов', initials='Н.В.', sex='M', birth_date='1980-08-25', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00092262;
UPDATE personnel_v2.employee SET "name"='Александра', patronymic='Олеговна', surname='Худобородова', initials='А.О.', sex='F', birth_date='1979-10-17', citizenship='RU', marital_status=2, marital_status_date='2019-06-28', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00092370;
UPDATE personnel_v2.employee SET "name"='Екатерина', patronymic='Рашитовна', surname='Титова', initials='Е.Р.', sex='F', birth_date='1976-04-02', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00092491;
UPDATE personnel_v2.employee SET "name"='Надежда', patronymic='Леонидовна', surname='Швецова', initials='Н.Л.', sex='F', birth_date='1986-09-30', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00092515;
UPDATE personnel_v2.employee SET "name"='Евгений', patronymic='Викторович', surname='Выходцев', initials='Е.В.', sex='M', birth_date='1972-11-28', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00092663;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Викторович', surname='Кулешов', initials='А.В.', sex='M', birth_date='1987-06-25', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00093110;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Владимирович', surname='Линьков', initials='А.В.', sex='M', birth_date='1978-09-29', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00093192;
UPDATE personnel_v2.employee SET "name"='Владимир', patronymic='Александрович', surname='Баев', initials='В.А.', sex='M', birth_date='1972-05-09', citizenship='RU', marital_status=2, marital_status_date='1999-11-12', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00093402;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Сергеевич', surname='Желнов', initials='А.С.', sex='M', birth_date='1980-10-10', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00093628;
UPDATE personnel_v2.employee SET "name"='Антон', patronymic='Михайлович', surname='Муска', initials='А.М.', sex='M', birth_date='1985-01-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00093665;
UPDATE personnel_v2.employee SET "name"='Юлия', patronymic='Сергеевна', surname='Наточий', initials='Ю.С.', sex='F', birth_date='1989-02-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00093760;
UPDATE personnel_v2.employee SET "name"='Ольга', patronymic='Александровна', surname='Филатова', initials='О.А.', sex='F', birth_date='1985-02-11', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00094311;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Сергеевна', surname='Иванцова', initials='Н.С.', sex='F', birth_date='1987-10-12', citizenship='RU', marital_status=2, marital_status_date='2019-05-17', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00094349;
UPDATE personnel_v2.employee SET "name"='Денис', patronymic='Артемович', surname='Заварзин', initials='Д.А.', sex='M', birth_date='1991-12-05', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00094740;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Олегович', surname='Шишпанов', initials='А.О.', sex='M', birth_date='1992-09-03', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00094947;
UPDATE personnel_v2.employee SET "name"='Елена', patronymic='Сергеевна', surname='Кривогузова', initials='Е.С.', sex='F', birth_date='1987-01-25', citizenship='RU', marital_status=2, marital_status_date='2025-10-16', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00095451;
UPDATE personnel_v2.employee SET "name"='Ольга', patronymic='Сергеевна', surname='Борисова', initials='О.С.', sex='F', birth_date='1989-04-12', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00095690;
UPDATE personnel_v2.employee SET "name"='Екатерина', patronymic='Юрьевна', surname='Матвиенко', initials='Е.Ю.', sex='F', birth_date='1991-04-09', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00095954;
UPDATE personnel_v2.employee SET "name"='Полина', patronymic='Николаевна', surname='Носикова', initials='П.Н.', sex='F', birth_date='1981-03-20', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00096110;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Александрович', surname='Мамонтов', initials='А.А.', sex='M', birth_date='1974-10-06', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00096287;
UPDATE personnel_v2.employee SET "name"='Ильдар', patronymic='Рафикович', surname='Абаков', initials='И.Р.', sex='M', birth_date='1988-08-27', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00096579;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Александрович', surname='Грибенко', initials='А.А.', sex='M', birth_date='1988-02-16', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00097087;
UPDATE personnel_v2.employee SET "name"='Петр', patronymic='Александрович', surname='Финько', initials='П.А.', sex='M', birth_date='1970-07-11', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00097121;
UPDATE personnel_v2.employee SET "name"='Максим', patronymic='Сергеевич', surname='Семихов', initials='М.С.', sex='M', birth_date='1993-08-23', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00097764;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Сергеевич', surname='Плешков', initials='С.С.', sex='M', birth_date='1988-03-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00097814;
UPDATE personnel_v2.employee SET "name"='Юлия', patronymic='Вячеславовна', surname='Каньшина', initials='Ю.В.', sex='F', birth_date='1978-12-23', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00098090;
UPDATE personnel_v2.employee SET "name"='Артём', patronymic='Юрьевич', surname='Арсентьев', initials='А.Ю.', sex='M', birth_date='1986-07-06', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00098286;
UPDATE personnel_v2.employee SET "name"='Максим', patronymic='Станиславович', surname='Максимов', initials='М.С.', sex='M', birth_date='1983-05-16', citizenship='RU', marital_status=2, marital_status_date='2015-09-25', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00098613;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Валерьевич', surname='Евстифеев', initials='А.В.', sex='M', birth_date='1986-11-01', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00098757;
UPDATE personnel_v2.employee SET "name"='Илья', patronymic='Сергеевич', surname='Селезнев', initials='И.С.', sex='M', birth_date='1993-06-07', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00098906;
UPDATE personnel_v2.employee SET "name"='Дарья', patronymic='Алексеевна', surname='Данилова', initials='Д.А.', sex='F', birth_date='1990-08-18', citizenship='RU', marital_status=2, marital_status_date='2016-10-01', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00099166;
UPDATE personnel_v2.employee SET "name"='Равиль', patronymic='Салаватович', surname='Загидуллин', initials='Р.С.', sex='M', birth_date='1992-03-12', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00099568;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Валерьевич', surname='Быстров', initials='С.В.', sex='M', birth_date='1971-12-27', citizenship='RU', marital_status=2, marital_status_date='2010-01-15', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00100224;
UPDATE personnel_v2.employee SET "name"='Ольга', patronymic='Константиновна', surname='Маркова', initials='О.К.', sex='F', birth_date='1982-03-03', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00100270;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Васильевич', surname='Архипов', initials='А.В.', sex='M', birth_date='1991-03-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00101446;
UPDATE personnel_v2.employee SET "name"='Любовь', patronymic='Евгеньевна', surname='Стефанцова', initials='Л.Е.', sex='F', birth_date='1990-12-21', citizenship='RU', marital_status=2, marital_status_date='2025-03-01', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00101922;
UPDATE personnel_v2.employee SET "name"='Екатерина', patronymic='Сергеевна', surname='Кармызова', initials='Е.С.', sex='F', birth_date='1991-01-08', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00102086;
UPDATE personnel_v2.employee SET "name"='Эдуард', patronymic='Азатович', surname='Абдуллин', initials='Э.А.', sex='M', birth_date='1994-01-06', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00102167;
UPDATE personnel_v2.employee SET "name"='Денис', patronymic='Олегович', surname='Ушкалов', initials='Д.О.', sex='M', birth_date='1991-07-30', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00102534;
UPDATE personnel_v2.employee SET "name"='Игорь', patronymic='Валентинович', surname='Бойков', initials='И.В.', sex='M', birth_date='1962-12-21', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00102897;
UPDATE personnel_v2.employee SET "name"='Григорий', patronymic='Николаевич', surname='Орлов', initials='Г.Н.', sex='M', birth_date='1991-11-26', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00103034;
UPDATE personnel_v2.employee SET "name"='Анна', patronymic='Валерьевна', surname='Игнатенкова', initials='А.В.', sex='F', birth_date='1989-10-25', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00103109;
UPDATE personnel_v2.employee SET "name"='Виктория', patronymic='Александровна', surname='Анциферова', initials='В.А.', sex='F', birth_date='1988-11-20', citizenship='RU', marital_status=2, marital_status_date='2021-09-05', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00103144;
UPDATE personnel_v2.employee SET "name"='Людмила', patronymic='Викторовна', surname='Демьянова', initials='Л.В.', sex='F', birth_date='1990-02-06', citizenship='RU', marital_status=2, marital_status_date='2021-09-21', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00103214;
UPDATE personnel_v2.employee SET "name"='Леонид', patronymic='Николаевич', surname='Соколов', initials='Л.Н.', sex='M', birth_date='1995-08-25', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00103575;
UPDATE personnel_v2.employee SET "name"='Владимир', patronymic='Сергеевич', surname='Корниенко', initials='В.С.', sex='M', birth_date='1981-08-18', citizenship='RU', marital_status=2, marital_status_date='2011-06-04', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00103683;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Дмитриевич', surname='Королев', initials='С.Д.', sex='M', birth_date='1994-06-08', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00104642;
UPDATE personnel_v2.employee SET "name"='Ксения', patronymic='Александровна', surname='Локотина', initials='К.А.', sex='F', birth_date='1995-05-12', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00104905;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Александрович', surname='Бычков', initials='А.А.', sex='M', birth_date='1984-05-02', citizenship='RU', marital_status=2, marital_status_date='2015-04-25', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00104963;
UPDATE personnel_v2.employee SET "name"='Тамара', patronymic='Валерьевна', surname='Подгурская', initials='Т.В.', sex='F', birth_date='1991-12-25', citizenship='RU', marital_status=2, marital_status_date='2019-03-16', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00105420;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Константиновна', surname='Чеснокова', initials='А.К.', sex='F', birth_date='1992-01-15', citizenship='RU', marital_status=2, marital_status_date='2025-12-12', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00105671;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Владимировна', surname='Бережная', initials='Н.В.', sex='F', birth_date='1986-01-31', citizenship='RU', marital_status=2, marital_status_date='2018-04-20', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00106171;
UPDATE personnel_v2.employee SET "name"='Жора', patronymic='Мукучевич', surname='Чапарян', initials='Ж. М.', sex='M', birth_date='1999-03-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00106403;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Игоревич', surname='Дюбин', initials='А.И.', sex='M', birth_date='1988-12-09', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00108036;
UPDATE personnel_v2.employee SET "name"='Нино', patronymic='Димитриевна', surname='Вахания', initials='Н.Д.', sex='F', birth_date='1991-01-23', citizenship='RU', marital_status=5, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00108092;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Вячеславович', surname='Петров', initials='А.В.', sex='M', birth_date='1985-01-11', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00108280;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Владимирович', surname='Таюрский', initials='А.В.', sex='M', birth_date='1992-04-28', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00108365;
UPDATE personnel_v2.employee SET "name"='Павел', patronymic='Петрович', surname='Изотов', initials='П.П.', sex='M', birth_date='1992-08-14', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00109000;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Игоревна', surname='Осошник', initials='А.И.', sex='F', birth_date='2000-09-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00110470;
UPDATE personnel_v2.employee SET "name"='Септимус', patronymic='Алексеевич', surname='Атлант', initials='С.А.', sex='M', birth_date='1997-12-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00110612;
UPDATE personnel_v2.employee SET "name"='Марианна', patronymic='Юрьевна', surname='Болгова', initials='М.Ю.', sex='F', birth_date='1995-12-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00111000;
UPDATE personnel_v2.employee SET "name"='Евгений', patronymic='Алексеевич', surname='Тихомиров', initials='Е.А.', sex='M', birth_date='1995-06-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00111180;
UPDATE personnel_v2.employee SET "name"='Ольга', patronymic='Николаевна', surname='Яровикова', initials='О.Н.', sex='F', birth_date='1973-11-14', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00111436;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Владиславович', surname='Масляков', initials='А.В.', sex='M', birth_date='1981-01-14', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00111585;
UPDATE personnel_v2.employee SET "name"='Руслан', patronymic='Викторович', surname='Ребковец', initials='РВ', sex='M', birth_date='1997-01-11', citizenship='BY', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00111623;
UPDATE personnel_v2.employee SET "name"='Антон', patronymic='Юрьевич', surname='Анисимов', initials='АЮ', sex='M', birth_date='1997-04-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00111828;
UPDATE personnel_v2.employee SET "name"='Петр', patronymic='Александрович', surname='Тарасов', initials='П.А.', sex='M', birth_date='1993-08-17', citizenship='RU', marital_status=2, marital_status_date='2025-06-13', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00112135;
UPDATE personnel_v2.employee SET "name"='Елена', patronymic='Антоновна', surname='Мишина', initials='Е.А.', sex='F', birth_date='1996-07-24', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00112171;
UPDATE personnel_v2.employee SET "name"='Виктория', patronymic='Эльчиновна', surname='Аббасова', initials='В.Э.', sex='F', birth_date='1997-08-11', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00112182;
UPDATE personnel_v2.employee SET "name"='Владислав', patronymic='Александрович', surname='Лапшин', initials='В.А.', sex='M', birth_date='1995-08-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00115940;
UPDATE personnel_v2.employee SET "name"='Айгуль', patronymic='Альфитовна', surname='Хамидуллина', initials='А.А.', sex='F', birth_date='1997-10-07', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00116282;
UPDATE personnel_v2.employee SET "name"='Евгения', patronymic='Витальевна', surname='Егорова', initials='Е.В.', sex='F', birth_date='2000-09-10', citizenship='RU', marital_status=2, marital_status_date='2021-10-21', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00116289;
UPDATE personnel_v2.employee SET "name"='Евгений', patronymic='Евгеньевич', surname='Головко', initials='Е.Е.', sex='M', birth_date='1988-07-07', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00117113;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Геннадьевич', surname='Бураков', initials='А.Г.', sex='M', birth_date='1993-05-10', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118103;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Сергеевич', surname='Елисеев', initials='С.С.', sex='M', birth_date='2002-06-25', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118104;
UPDATE personnel_v2.employee SET "name"='Никита', patronymic='Александрович', surname='Гриничев', initials='Н.А.', sex='M', birth_date='1999-03-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118105;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Вячеславович', surname='Сергеев', initials='А.В.', sex='M', birth_date='2002-02-12', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118133;
UPDATE personnel_v2.employee SET "name"='Илья', patronymic='Андреевич', surname='Волков', initials='И.А.', sex='M', birth_date='2002-09-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118140;
UPDATE personnel_v2.employee SET "name"='Антон', patronymic='Владимирович', surname='Редькин', initials='А.В.', sex='M', birth_date='2002-08-16', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118151;
UPDATE personnel_v2.employee SET "name"='Данила', patronymic='Денисович', surname='Поджаров', initials='Д.Д.', sex='M', birth_date='2001-11-05', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118152;
UPDATE personnel_v2.employee SET "name"='Антон', patronymic='Игоревич', surname='Усов', initials='А.И.', sex='M', birth_date='2003-04-01', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118160;
UPDATE personnel_v2.employee SET "name"='Григорий', patronymic='Константинович', surname='Поляков', initials='Г.К.', sex='M', birth_date='2002-09-24', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118165;
UPDATE personnel_v2.employee SET "name"='Владислав', patronymic='Андреевич', surname='Царьков', initials='В.А.', sex='M', birth_date='2003-01-14', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118178;
UPDATE personnel_v2.employee SET "name"='Денис', patronymic='Павлович', surname='Завьялов', initials='Д.П.', sex='M', birth_date='2002-05-25', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118179;
UPDATE personnel_v2.employee SET "name"='Василиса', patronymic='Егоровна', surname='Юрченко', initials='В.Е.', sex='F', birth_date='2003-01-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118204;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Владимирович', surname='Быковский', initials='А.В.', sex='M', birth_date='2002-01-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118243;
UPDATE personnel_v2.employee SET "name"='Дмитрий', patronymic='Константинович', surname='Чуй', initials='Д.К.', sex='M', birth_date='1997-07-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00118361;
UPDATE personnel_v2.employee SET "name"='Вероника', patronymic='Викторовна', surname='Щербенко', initials='В.В.', sex='F', birth_date='1971-07-23', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121053;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Анатольевна', surname='Арсенчук', initials='Н.А.', sex='F', birth_date='1969-08-04', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121230;
UPDATE personnel_v2.employee SET "name"='Семён', patronymic='Евгеньевич', surname='Семенюк', initials='С.Е.', sex='M', birth_date='2001-09-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121248;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Александрович', surname='Шабельник', initials='А.А.', sex='M', birth_date='2001-12-18', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121337;
UPDATE personnel_v2.employee SET "name"='Максим', patronymic='Александрович', surname='Косов', initials='М.А.', sex='M', birth_date='2001-11-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121362;
UPDATE personnel_v2.employee SET "name"='Никита', patronymic='Сергеевич', surname='Крутов', initials='Н.С.', sex='M', birth_date='2001-10-24', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121421;
UPDATE personnel_v2.employee SET "name"='Мурад', patronymic='Алиханович', surname='Худавердиев', initials='М.А.', sex='M', birth_date='2004-06-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121537;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Анатольевич', surname='Красилов', initials='А.А.', sex='M', birth_date='2003-11-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121550;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Владимирович', surname='Калашко', initials='С.В.', sex='M', birth_date='1991-09-07', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121567;
UPDATE personnel_v2.employee SET "name"='Дмитрий', patronymic='Эдуардович', surname='Алексеев', initials='Д.Э.', sex='M', birth_date='1997-01-10', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121644;
UPDATE personnel_v2.employee SET "name"='Владислав', patronymic='Евгеньевич', surname='Караваев', initials='В.Е.', sex='M', birth_date='2003-07-26', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121835;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Александрович', surname='Кравцов', initials='А.А.', sex='M', birth_date='2003-01-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121840;
UPDATE personnel_v2.employee SET "name"='Егор', patronymic='Дмитриевич', surname='Делимарский', initials='Е.Д.', sex='M', birth_date='2004-04-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121853;
UPDATE personnel_v2.employee SET "name"='Иван', patronymic='Алексеевич', surname='Ефремов', initials='И.А.', sex='M', birth_date='1998-02-20', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00121855;
UPDATE personnel_v2.employee SET "name"='Леонид', patronymic='Владимирович', surname='Сошников', initials='Л.В.', sex='M', birth_date='1972-05-29', citizenship='RU', marital_status=2, marital_status_date='2015-05-08', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00122271;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Александровна', surname='Парфеньева', initials='А.А.', sex='F', birth_date='1981-10-24', citizenship='RU', marital_status=2, marital_status_date='2018-10-13', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00122299;
UPDATE personnel_v2.employee SET "name"='Эльвира', patronymic='Джаваншировна', surname='Линейцева', initials='Э.Д.', sex='F', birth_date='1985-08-26', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00122399;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Александровна', surname='Миронова', initials='А.', sex='F', birth_date='1994-12-24', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00122508;
UPDATE personnel_v2.employee SET "name"='Анна', patronymic='Андреевна', surname='Кирина', initials='А.А.', sex='F', birth_date='1999-06-07', citizenship='RU', marital_status=2, marital_status_date='2025-04-22', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00123691;
UPDATE personnel_v2.employee SET "name"='Милена', patronymic='Юрьевна', surname='Медведева', initials='М.Ю.', sex='F', birth_date='2004-07-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00123800;
UPDATE personnel_v2.employee SET "name"='Жантемир', patronymic='Хамидбиевич', surname='Абрэдж', initials='Ж.Х.', sex='M', birth_date='1994-10-31', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00123835;
UPDATE personnel_v2.employee SET "name"='Анна', patronymic='Андреевна', surname='Штапова', initials='А.А.', sex='F', birth_date='1998-09-24', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00123851;
UPDATE personnel_v2.employee SET "name"='Валерия', patronymic='Сергеевна', surname='Сидоренко', initials='В.С.', sex='F', birth_date='2001-02-26', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00123879;
UPDATE personnel_v2.employee SET "name"='Мария', patronymic='Владимировна', surname='Герасимова', initials='М.В.', sex='F', birth_date='1998-09-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00123912;
UPDATE personnel_v2.employee SET "name"='София', patronymic='Эдуардовна', surname='Демьянова', initials='С.Э.', sex='F', birth_date='2003-10-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00123950;
UPDATE personnel_v2.employee SET "name"='Алина', patronymic='Амановна', surname='Кубрак', initials='А.А.', sex='F', birth_date='2000-01-20', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00124076;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Анатольевна', surname='Колчина', initials='А.А.', sex='F', birth_date='1995-11-10', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00124284;
UPDATE personnel_v2.employee SET "name"='Мирон', patronymic='Юрьевич', surname='Мартьянов', initials='М.Ю.', sex='M', birth_date='2001-01-10', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00124488;
UPDATE personnel_v2.employee SET "name"='Герман', patronymic='Алексеевич', surname='Грищенко', initials='Г.А.', sex='M', birth_date='2001-04-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00124949;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Дмитриевич', surname='Виноградов', initials='С.Д.', sex='M', birth_date='1995-10-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00125623;
UPDATE personnel_v2.employee SET "name"='Роман', patronymic='Сергеевич', surname='Зинковский', initials='РС', sex='M', birth_date='1995-07-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00125638;
UPDATE personnel_v2.employee SET "name"='Яна', patronymic='Николаевна', surname='Кудринская', initials='Я.Н.', sex='F', birth_date='1997-06-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00125878;
UPDATE personnel_v2.employee SET "name"='Виктория', patronymic='Вадимовна', surname='Козырева', initials='В.В.', sex='F', birth_date='2006-03-14', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00126002;
UPDATE personnel_v2.employee SET "name"='Асият', patronymic='Камилевна', surname='Шапиева', initials='А.К.', sex='F', birth_date='2002-08-26', citizenship='RU', marital_status=2, marital_status_date='2025-06-16', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00126205;
UPDATE personnel_v2.employee SET "name"='Наталья', patronymic='Эдуардовна', surname='Пономарь', initials='Н.Э.', sex='F', birth_date='1991-07-18', citizenship='RU', marital_status=2, marital_status_date='2012-06-15', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00126266;
UPDATE personnel_v2.employee SET "name"='Гор', patronymic='Мурджикович', surname='Саядян', initials='Г.М.', sex='M', birth_date='1997-03-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00126424;
UPDATE personnel_v2.employee SET "name"='Дарья', patronymic='Сергеевна', surname='Гладкова', initials='Д.С.', sex='F', birth_date='2003-04-30', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00126677;
UPDATE personnel_v2.employee SET "name"='Кристина', patronymic='Эдуардовна', surname='Жданова', initials='К.Э.', sex='F', birth_date='1997-11-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127033;
UPDATE personnel_v2.employee SET "name"='Михаил', patronymic='Евгеньевич', surname='Данилин', initials='М.Е.', sex='M', birth_date='2002-10-16', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127197;
UPDATE personnel_v2.employee SET "name"='Дарья', patronymic='Александровна', surname='Мотылева', initials='Д.А.', sex='F', birth_date='1999-12-16', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127263;
UPDATE personnel_v2.employee SET "name"='Алина', patronymic='Геннадьевна', surname='Каргина', initials='А.Г.', sex='F', birth_date='2004-12-01', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127350;
UPDATE personnel_v2.employee SET "name"='Ильгиз', patronymic='Файрузович', surname='Исянгулов', initials='И.Ф.', sex='M', birth_date='1984-04-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127383;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Андреевна', surname='Федотов', initials='А.А.', sex='F', birth_date='1993-05-06', citizenship='RU', marital_status=2, marital_status_date='2014-07-12', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127404;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Ивановна', surname='Шумкова', initials='А.И.', sex='F', birth_date='2006-06-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127459;
UPDATE personnel_v2.employee SET "name"='Анна', patronymic='Вячеславовна', surname='Трубеко', initials='А.В.', sex='F', birth_date='1966-03-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127606;
UPDATE personnel_v2.employee SET "name"='Михаил', patronymic='Константинович', surname='Дронов', initials='М.К.', sex='M', birth_date='2001-01-01', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127739;
UPDATE personnel_v2.employee SET "name"='Аркадий', patronymic='Юрьевич', surname='Серов', initials='А.Ю.', sex='M', birth_date='1998-07-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127805;
UPDATE personnel_v2.employee SET "name"='Антон', patronymic='Андреевич', surname='Пестов', initials='А.А.', sex='M', birth_date='1995-06-08', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127923;
UPDATE personnel_v2.employee SET "name"='Мария', patronymic='Юрьевна', surname='Лепшенкова', initials='М.Ю.', sex='F', birth_date='2004-11-18', citizenship='BY', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00127953;
UPDATE personnel_v2.employee SET "name"='Артур', patronymic='Русланович', surname='Байгузин', initials='А.Р.', sex='M', birth_date='1999-06-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128023;
UPDATE personnel_v2.employee SET "name"='Виктория', patronymic='Дмитриевна', surname='Токарева', initials='В.Д.', sex='F', birth_date='2004-10-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128060;
UPDATE personnel_v2.employee SET "name"='Егор', patronymic='Денисович', surname='Подпольный', initials='Е.Д.', sex='M', birth_date='2002-11-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128196;
UPDATE personnel_v2.employee SET "name"='Надежда', patronymic='Вадимовна', surname='Скопинцева', initials='Н.В.', sex='F', birth_date='2005-08-24', citizenship='RU', marital_status=2, marital_status_date='2025-05-05', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128246;
UPDATE personnel_v2.employee SET "name"='Юрий', patronymic='Викторович', surname='Быков', initials='Ю.В.', sex='M', birth_date='1987-02-02', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128456;
UPDATE personnel_v2.employee SET "name"='Мустафа', patronymic='Назирович', surname='Кадракаев', initials='М.Н.', sex='M', birth_date='1996-04-27', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128503;
UPDATE personnel_v2.employee SET "name"='Данила', patronymic='Владимирович', surname='Марфин', initials='Д.В.', sex='M', birth_date='2000-09-23', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128508;
UPDATE personnel_v2.employee SET "name"='Игорь', patronymic='Игоревич', surname='Ильичев', initials='И.И.', sex='M', birth_date='1983-11-03', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128515;
UPDATE personnel_v2.employee SET "name"='Оксана', patronymic='Васильевна', surname='Мизина', initials='О.В.', sex='F', birth_date='1990-01-03', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128535;
UPDATE personnel_v2.employee SET "name"='Николай', patronymic='Игоревич', surname='Бондарчук', initials='Н.И.', sex='M', birth_date='2000-12-18', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128570;
UPDATE personnel_v2.employee SET "name"='Александра', patronymic='Андреевна', surname='Корчинелли', initials='А.А.', sex='F', birth_date='2005-12-12', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128596;
UPDATE personnel_v2.employee SET "name"='Антонина', patronymic='Николаевна', surname='Тютюнова', initials='А.Н.', sex='F', birth_date='1983-05-11', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128745;
UPDATE personnel_v2.employee SET "name"='Левон', patronymic='Каренович', surname='Макарян', initials='Л.К.', sex='M', birth_date='1997-06-10', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128817;
UPDATE personnel_v2.employee SET "name"='Левон', patronymic='Каренович', surname='Макарян', initials='Л.К.', sex='M', birth_date='1997-06-10', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128822;
UPDATE personnel_v2.employee SET "name"='Антон', patronymic='Павлович', surname='Турбабин', initials='А.П.', sex='M', birth_date='1991-12-17', citizenship='RU', marital_status=2, marital_status_date='2017-06-07', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128825;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Алексеевич', surname='Боярко', initials='А.А.', sex='M', birth_date='1987-09-16', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128827;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Андреевич', surname='Белоус', initials='А.А.', sex='M', birth_date='1997-02-26', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128841;
UPDATE personnel_v2.employee SET "name"='Эдуард', patronymic='Сергеевич', surname='Кравчук', initials='Э.С.', sex='M', birth_date='1995-04-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128842;
UPDATE personnel_v2.employee SET "name"='Юрий', patronymic='Владимирович', surname='Попов', initials='Ю.В.', sex='M', birth_date='1980-09-23', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128853;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Васильевич', surname='Колганов', initials='С.В.', sex='M', birth_date='1994-03-15', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128889;
UPDATE personnel_v2.employee SET "name"='Егор', patronymic='Сергеевич', surname='Дзинтарнек', initials='Е.С.', sex='M', birth_date='2000-05-23', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128894;
UPDATE personnel_v2.employee SET "name"='Константин', patronymic='Михайлович', surname='Ганженко', initials='К.М.', sex='M', birth_date='1987-08-12', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128896;
UPDATE personnel_v2.employee SET "name"='Тимур', patronymic='Алишерович', surname='Камалов', initials='Т.А.', sex='M', birth_date='1996-06-20', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00128897;
UPDATE personnel_v2.employee SET "name"='Светлана', patronymic='Владимировна', surname='Селиверстова', initials='С.В.', sex='F', birth_date='2003-08-23', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129049;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Андреевич', surname='Ельцов', initials='А.А.', sex='M', birth_date='1990-09-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129052;
UPDATE personnel_v2.employee SET "name"='Оксана', patronymic='Эдуардовна', surname='Чеглакова', initials='О.Э.', sex='F', birth_date='2003-11-26', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129104;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Андреевна', surname='Дроздова', initials='А.А.', sex='F', birth_date='2007-05-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129113;
UPDATE personnel_v2.employee SET "name"='Яна', patronymic='Олеговна', surname='Кузьмина', initials='Я.О.', sex='F', birth_date='2005-01-03', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129125;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Геннадьевич', surname='Ольшанников', initials='А.Г.', sex='M', birth_date='1996-11-12', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129128;
UPDATE personnel_v2.employee SET "name"='Диана', patronymic='Вадимовна', surname='Багавиева', initials='Д.В.', sex='F', birth_date='2006-06-28', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129180;
UPDATE personnel_v2.employee SET "name"='Арина', patronymic='Вадимовна', surname='Бикбулатова', initials='А.В.', sex='F', birth_date='2006-05-31', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129216;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Олеговна', surname='Кондрова', initials='А.О.', sex='F', birth_date='2003-04-01', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129223;
UPDATE personnel_v2.employee SET "name"='Ульяна', patronymic='Валерьевна', surname='Северюхина', initials='У.В.', sex='F', birth_date='2001-09-19', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129227;
UPDATE personnel_v2.employee SET "name"='Марина', patronymic='Евгеньевна', surname='Харитонова', initials='М.Е.', sex='F', birth_date='2002-11-12', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129228;
UPDATE personnel_v2.employee SET "name"='Анна', patronymic='Олеговна', surname='Ширина', initials='А.О.', sex='F', birth_date='2004-01-16', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129229;
UPDATE personnel_v2.employee SET "name"='Роман', patronymic='Дмитриевич', surname='Носков', initials='Р.Д.', sex='M', birth_date='2002-09-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129302;
UPDATE personnel_v2.employee SET "name"='Демид', patronymic='Викторович', surname='Сорокин', initials='Д.В.', sex='M', birth_date='2001-10-27', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129303;
UPDATE personnel_v2.employee SET "name"='Наталия', patronymic='', surname='Трофимова', initials='Н.', sex='F', birth_date='2005-06-28', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129350;
UPDATE personnel_v2.employee SET "name"='Владислав', patronymic='Витальевич', surname='Медяков', initials='В.В.', sex='M', birth_date='2002-11-02', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129361;
UPDATE personnel_v2.employee SET "name"='Захар', patronymic='Николаевич', surname='Автамонов', initials='З.Н.', sex='M', birth_date='2003-09-10', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129399;
UPDATE personnel_v2.employee SET "name"='Ольга', patronymic='Максимовна', surname='Бережная', initials='О.М.', sex='F', birth_date='2004-07-09', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129400;
UPDATE personnel_v2.employee SET "name"='Алина', patronymic='Игоревна', surname='Василюс', initials='А.И.', sex='F', birth_date='2007-09-19', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129411;
UPDATE personnel_v2.employee SET "name"='Виктория', patronymic='Денисовна', surname='Вандышева', initials='В.Д.', sex='F', birth_date='2007-07-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129412;
UPDATE personnel_v2.employee SET "name"='Милана', patronymic='Игоревна', surname='Винокурова', initials='М.И.', sex='F', birth_date='2002-12-08', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129413;
UPDATE personnel_v2.employee SET "name"='Николай', patronymic='Валерьевич', surname='Горшков', initials='Н.В.', sex='M', birth_date='1999-08-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129414;
UPDATE personnel_v2.employee SET "name"='Полина', patronymic='Романовна', surname='Гужева', initials='П.Р.', sex='F', birth_date='2003-10-29', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129415;
UPDATE personnel_v2.employee SET "name"='Кира', patronymic='Евгеньевна', surname='Денисова', initials='К.Е.', sex='F', birth_date='2006-12-15', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129416;
UPDATE personnel_v2.employee SET "name"='Антон', patronymic='Алексеевич', surname='Зенин', initials='А.А.', sex='M', birth_date='2007-01-30', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129417;
UPDATE personnel_v2.employee SET "name"='Карина', patronymic='Дмитриевна', surname='Колесник', initials='К.Д.', sex='F', birth_date='2003-03-07', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129418;
UPDATE personnel_v2.employee SET "name"='Карина', patronymic='Кирилловна', surname='Красноперова', initials='К.К.', sex='F', birth_date='2006-04-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129419;
UPDATE personnel_v2.employee SET "name"='Мария', patronymic='Сергеевна', surname='Поликарпова', initials='М.С.', sex='F', birth_date='2003-08-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129420;
UPDATE personnel_v2.employee SET "name"='Диана', patronymic='Юрьевна', surname='Попова', initials='Д.Ю.', sex='F', birth_date='2006-03-20', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129421;
UPDATE personnel_v2.employee SET "name"='Анна', patronymic='Дмитриевна', surname='Симагина', initials='А.Д.', sex='F', birth_date='2007-02-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129422;
UPDATE personnel_v2.employee SET "name"='Мария', patronymic='Сергеевна', surname='Суханова', initials='М.С.', sex='F', birth_date='2006-06-11', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129423;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Михайловна', surname='Уварова', initials='А.М.', sex='F', birth_date='2004-01-03', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129424;
UPDATE personnel_v2.employee SET "name"='Степан', patronymic='Сергеевич', surname='Холод', initials='С.С.', sex='M', birth_date='2005-01-18', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129425;
UPDATE personnel_v2.employee SET "name"='Юлия', patronymic='Григорьевна', surname='Юркова', initials='Ю.Г.', sex='F', birth_date='2003-07-02', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129426;
UPDATE personnel_v2.employee SET "name"='София', patronymic='Александровна', surname='Гвоздырева', initials='С.А.', sex='F', birth_date='2003-06-03', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129429;
UPDATE personnel_v2.employee SET "name"='Мария', patronymic='Игоревна', surname='Беднякова', initials='М.И.', sex='F', birth_date='2003-11-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129430;
UPDATE personnel_v2.employee SET "name"='Артём', patronymic='Анатольевич', surname='Дубин', initials='А.А.', sex='M', birth_date='2000-08-25', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129432;
UPDATE personnel_v2.employee SET "name"='Асель', patronymic='Улановна', surname='Исмаилова', initials='А.У.', sex='F', birth_date='2001-12-17', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129435;
UPDATE personnel_v2.employee SET "name"='Лилиана', patronymic='Александровна', surname='Коновалова', initials='Л.А.', sex='F', birth_date='2004-02-27', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129437;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Владимировна', surname='Майс', initials='А.В.', sex='F', birth_date='2002-11-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129438;
UPDATE personnel_v2.employee SET "name"='Дмитрий', patronymic='Михайлович', surname='Малинин', initials='Д.М.', sex='M', birth_date='2001-07-11', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129439;
UPDATE personnel_v2.employee SET "name"='Валерия', patronymic='Эдуардовна', surname='Наумова', initials='В.Э.', sex='F', birth_date='2002-08-27', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129440;
UPDATE personnel_v2.employee SET "name"='Светлана', patronymic='Сергеевна', surname='Мыльникова', initials='С.С.', sex='F', birth_date='2003-11-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129443;
UPDATE personnel_v2.employee SET "name"='Александр', patronymic='Васильевич', surname='Тиманов', initials='А.В.', sex='M', birth_date='2000-03-24', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129445;
UPDATE personnel_v2.employee SET "name"='Данил', patronymic='Мансурович', surname='Хайбуллин', initials='Д.М.', sex='M', birth_date='1999-06-08', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129446;
UPDATE personnel_v2.employee SET "name"='Полина', patronymic='Антоновна', surname='Шаихова', initials='П.А.', sex='F', birth_date='2007-08-08', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129447;
UPDATE personnel_v2.employee SET "name"='Ксения', patronymic='Андреевна', surname='Щепотьева', initials='К.А.', sex='F', birth_date='2004-01-24', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129448;
UPDATE personnel_v2.employee SET "name"='Анастасия', patronymic='Николаевна', surname='Шилова', initials='А.Н.', sex='F', birth_date='2003-05-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129449;
UPDATE personnel_v2.employee SET "name"='Полина', patronymic='Игоревна', surname='Кузнецова', initials='П.И.', sex='F', birth_date='2004-05-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129480;
UPDATE personnel_v2.employee SET "name"='Юлия', patronymic='Васильевна', surname='Ковтун', initials='Ю.В.', sex='F', birth_date='2002-02-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129540;
UPDATE personnel_v2.employee SET "name"='Мария', patronymic='Маратовна', surname='Федосюк', initials='М.М.', sex='F', birth_date='2006-11-16', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129542;
UPDATE personnel_v2.employee SET "name"='Никита', patronymic='Андреевич', surname='Сурогин', initials='Н.А.', sex='M', birth_date='2003-09-14', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129564;
UPDATE personnel_v2.employee SET "name"='Дмитрий', patronymic='Андреевич', surname='Дружинин', initials='Д.А.', sex='M', birth_date='2003-01-30', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129594;
UPDATE personnel_v2.employee SET "name"='Камила', patronymic='Фарходовна', surname='Хакимжанова', initials='К.Ф.', sex='F', birth_date='1998-08-25', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129666;
UPDATE personnel_v2.employee SET "name"='Алеся', patronymic='Андреевна', surname='Рудакова', initials='А.А.', sex='F', birth_date='2003-01-13', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129667;
UPDATE personnel_v2.employee SET "name"='Денис', patronymic='Сергеевич', surname='Попов', initials='Д.С.', sex='M', birth_date='1980-11-21', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129668;
UPDATE personnel_v2.employee SET "name"='Андрей', patronymic='Вячеславович', surname='Степанов', initials='А.В.', sex='M', birth_date='1992-02-21', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129671;
UPDATE personnel_v2.employee SET "name"='Ирина', patronymic='Александровна', surname='Ващенко', initials='И.А.', sex='F', birth_date='1983-05-19', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129683;
UPDATE personnel_v2.employee SET "name"='Ирина', patronymic='Геннадьевна', surname='Якунина', initials='И.Г.', sex='F', birth_date='1990-09-05', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129687;
UPDATE personnel_v2.employee SET "name"='Дарья', patronymic='Андреевна', surname='Евдюкова', initials='Д.А.', sex='F', birth_date='1998-10-26', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129688;
UPDATE personnel_v2.employee SET "name"='Ирада', patronymic='Видадиевна', surname='Баринская', initials='И.В.', sex='F', birth_date='1987-05-16', citizenship='RU', marital_status=2, marital_status_date='2012-08-24', update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129689;
UPDATE personnel_v2.employee SET "name"='Павел', patronymic='Зиновьевич', surname='Гельван', initials='П.З.', sex='M', birth_date='1971-09-16', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129690;
UPDATE personnel_v2.employee SET "name"='Алексей', patronymic='Борисович', surname='Вахрамеев', initials='А.Б.', sex='M', birth_date='1981-11-02', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129691;
UPDATE personnel_v2.employee SET "name"='Сергей', patronymic='Владимирович', surname='Прокофьев', initials='С.В.', sex='M', birth_date='1983-09-25', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129692;
UPDATE personnel_v2.employee SET "name"='Алиса', patronymic='Игоревна', surname='Простакова', initials='А.И.', sex='F', birth_date='2000-03-30', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129698;
UPDATE personnel_v2.employee SET "name"='Максим', patronymic='Александрович', surname='Орлов', initials='М.А.', sex='M', birth_date='1994-05-25', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129700;
UPDATE personnel_v2.employee SET "name"='Никита', patronymic='Алексеевич', surname='Левченко', initials='Н.А.', sex='M', birth_date='1996-10-25', citizenship='RU', marital_status=2, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129701;
UPDATE personnel_v2.employee SET "name"='Ярослав', patronymic='Станиславович', surname='Галкин', initials='Я.С.', sex='M', birth_date='2004-05-31', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129702;
UPDATE personnel_v2.employee SET "name"='Олеся', patronymic='Александровна', surname='Осадчая', initials='О.А.', sex='F', birth_date='2002-10-22', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129703;
UPDATE personnel_v2.employee SET "name"='Виктория', patronymic='Владимировна', surname='Филиппова', initials='В.В.', sex='F', birth_date='2006-12-01', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129704;
UPDATE personnel_v2.employee SET "name"='Алина', patronymic='Алексеевна', surname='Мижарева', initials='А.А.', sex='F', birth_date='2005-09-08', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129705;
UPDATE personnel_v2.employee SET "name"='Василиса', patronymic='Дмитриевна', surname='Фролова', initials='В.Д.', sex='F', birth_date='2007-11-19', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129706;
UPDATE personnel_v2.employee SET "name"='Светлана', patronymic='Юрьевна', surname='Леонова', initials='С.Ю.', sex='F', birth_date='2002-01-19', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129767;
UPDATE personnel_v2.employee SET "name"='Виктория', patronymic='Александровна', surname='Семенова', initials='В.А.', sex='F', birth_date='2001-12-20', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129779;
UPDATE personnel_v2.employee SET "name"='Кристина', patronymic='Александровна', surname='Никитина', initials='К.А.', sex='F', birth_date='2000-07-30', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129783;
UPDATE personnel_v2.employee SET "name"='Лилия', patronymic='Арменаковна', surname='Бош', initials='Л.А.', sex='F', birth_date='2003-12-24', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129784;
UPDATE personnel_v2.employee SET "name"='Карина', patronymic='Олеговна', surname='Болтенкова', initials='К.О.', sex='F', birth_date='1999-10-04', citizenship='RU', marital_status=1, marital_status_date=null, update_user='SYSTEM', update_date=now(), status=1, expired=false WHERE employee_number=00129787;

2.4.2. На деве меньше сотрудников, чем на Проде
На деве может не быть каких-то людей, так как они сейчас добавляются из Аккорда, а на деве нет интеграции с Аккордом.
Поэтому в этом случае отсутствующих сотрудников надо перенести с прода из таблицы employee. То же самое касается и других таблиц.
То есть:
1.	Сделать запрос в employee where employee_number in (список табельных номеров отсутствующих сотрудников)
2.	Сгенерировать INSERT-ы без поля ID
3.	Применить скрипт на дев-стенде


2.4.3. Сгененировать обновление для таблицы flight-info (базовый аэропорт)
flight-info 
--базовый аэропорт
--Обновить базовый аэропорт в flight_info для   
select * from (
select ids
    , row_number() over (partition by ids ORDER BY creationtime desc) id_rn    
    , 'update personnel_v2.flight_info set category = '||persk||', "section" = '||st.st_id||', base_airport = '||coalesce(sa.sa_id::text,'null')||', "position" = '''||plans||''', expired = false, update_user = ''SYSTEM'', update_date = now() where employee_number = '||ids||';' sql_update_flight_info
--    , 'INSERT INTO personnel_v2.flight_info (employee_number, category, "section", base_airport, "position", expired, create_user, create_date, update_user, update_date, akk_pers_main_id) VALUES('||ids||', '||persk||', '||st.st_id||', '||coalesce(sa.sa_id::text,'null')||', '''||plans||''', false, ''HF_0000'', now(), ''HF_0000'', now(), null);' sql_insert_flight_info
    , id,abkrs,begda,btrtl,endda,opera,pernr,persk, "plans",sacha,sachz,sbmod,seqnr,werks,st.st_id,sa_id,create_date,created_by,creationtime,idocnum,p_code,raw_message_id
from unnest(array[ 3488,5702,11603,12456,14227,14238,15186,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92262,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94740,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98286,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102248,102257,102271,102450,102472,102534,102587,102591,102626,102627,102628,102634,102691,102719,102775,102796,102798,102807,102809,102854,102897,103034,103079,103109,103112,103121,103144,103214,103228,103252,103321,103508,103533,103575,103683,103685,103750,104245,104277,104285,104298,104401,104420,104584,104642,104650,104676,104688,104707,104807,104812,104885,104901,104905,104916,104925,104926,104963,104975,105043,105102,105163,105205,105212,105224,105320,105327,105329,105333,105412,105420,105488,105521,105540,105633,105648,105669,105671,105698,105699,105882,105893,105908,105933,105940,105949,105953,106010,106077,106084,106096,106171,106175,106293,106297,106403,106428,106479,106508,106523,106526,106572,106581,106601,106666,106677,106678,107639,107803,107818,107836,107845,107848,107888,107896,107934,107961,108021,108036,108071,108091,108092,108093,108094,108110,108181,108238,108265,108280,108309,108351,108355,108365,108374,108469,108472,108476,108477,108492,108571,108573,108626,108631,108700,108743,108746,108893,108897,108902,108973,108976,108980,109000,109065,109470,109479,109513,109690,109784,109934,110092,110185,110194,110220,110255,110358,110438,110470,110580,110610,110612,110891,110902,110920,110921,110928,110958,110962,110999,111000,111001,111180,111182,111187,111227,111242,111379,111436,111514,111552,111585,111589,111623,111828,111935,111959,111999,112094,112100,112135,112171,112182,112640,115940,116038,116282,116289,116346,116399,116524,116561,116571,116577,116582,116604,116616,116619,116625,116640,116642,116646,116650,116656,116659,116662,116704,116725,116742,116746,116748,116752,116753,116766,116783,116785,116788,116791,116799,116824,116825,116826,116831,116835,116838,116842,116844,116846,116847,116852,116858,116896,116897,116900,116905,116908,116909,116921,116923,116933,116937,116949,116950,116960,116977,116984,116985,116996,117001,117002,117006,117012,117039,117043,117053,117054,117062,117063,117066,117070,117071,117073,117074,117075,117076,117077,117080,117083,117084,117089,117093,117113,117129,117130,117132,117134,117135,117138,117140,117143,117148,117149,117151,117152,117153,117154,117155,117249,117253,117255,117262,117266,117267,117270,117271,117314,117317,117327,117333,117338,117345,117361,117362,117415,117416,117417,117419,117422,117425,117427,117431,117432,117435,117436,117439,117441,117460,117462,117463,117465,117466,117468,117470,117487,117488,117489,117490,117494,117496,117497,117499,117682,117685,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121248,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122417,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,124949,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129049,129052,129104,129113,129125,129128,129180,129206,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129666,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
    ]) ids
left join public.parced_hrmd_lines_2 phl 
on p_code = 'P0001'
and pernr = LPAD(ids::text,8,'0')
and endda = '99991231'
and raw_message_id not like 'P%'  --убрать опорные выгрузки
left join dblink('dbname=ms-personnel host=192.168.199.217 port=5432 user=postgres password=password', 'select id as st_id,code from personnel_v2.section_type') as st(st_id int, code text) on st.code = phl.werks
left join dblink('dbname=ms-personnel host=192.168.199.217 port=5432 user=postgres password=password', 'select id as sa_id from personnel_v2.section_airport') as sa(sa_id int) on LPAD(sa.sa_id::text,4,'0') = phl.werks
) sorted 
where sorted.id_rn = 1
and id is not null
order by 1, creationtime;
2.4.3.1. Пример после генерации
flight-info пример 
update personnel_v2.flight_info set category = 38, "section" = 76, base_airport = 181, "position" = '50211363', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 3488;
update personnel_v2.flight_info set category = 38, "section" = 76, base_airport = 181, "position" = '50211374', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 5702;
update personnel_v2.flight_info set category = 38, "section" = 76, base_airport = 181, "position" = '50211378', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 11603;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50164279', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 12456;
update personnel_v2.flight_info set category = 35, "section" = 84, base_airport = 221, "position" = '50217394', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 14227;
update personnel_v2.flight_info set category = 38, "section" = 169, base_airport = null, "position" = '50176450', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 14238;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217350', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 15223;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50165315', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 15306;
update personnel_v2.flight_info set category = 38, "section" = 436, base_airport = null, "position" = '50194498', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 19015;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50172180', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 25480;
update personnel_v2.flight_info set category = 31, "section" = 143, base_airport = null, "position" = '50000714', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 33058;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217369', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 33324;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217336', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 33340;
update personnel_v2.flight_info set category = 35, "section" = 84, base_airport = 221, "position" = '50217359', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 33358;
update personnel_v2.flight_info set category = 71, "section" = 76, base_airport = 181, "position" = '50074766', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 33375;
update personnel_v2.flight_info set category = 38, "section" = 18, base_airport = null, "position" = '50210958', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 34202;
update personnel_v2.flight_info set category = 38, "section" = 417, base_airport = null, "position" = '50192966', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 34555;
update personnel_v2.flight_info set category = 38, "section" = 106, base_airport = null, "position" = '50193592', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 34607;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217393', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 34952;
update personnel_v2.flight_info set category = 38, "section" = 120, base_airport = null, "position" = '50195042', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 39868;
update personnel_v2.flight_info set category = 38, "section" = 185, base_airport = null, "position" = '50217506', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 44494;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203256', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 46610;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203336', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 46909;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '99999999', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 47141;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203422', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 47725;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204286', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 48293;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202738', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 49000;
update personnel_v2.flight_info set category = 38, "section" = 106, base_airport = null, "position" = '50193638', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 54868;
update personnel_v2.flight_info set category = 35, "section" = 28, base_airport = null, "position" = '50209162', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 64341;
update personnel_v2.flight_info set category = 38, "section" = 85, base_airport = null, "position" = '50182365', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 64735;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217361', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 65778;
update personnel_v2.flight_info set category = 35, "section" = 435, base_airport = null, "position" = '50193709', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 66063;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50214984', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 66504;
update personnel_v2.flight_info set category = 38, "section" = 162, base_airport = null, "position" = '50180001', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 69754;
update personnel_v2.flight_info set category = 40, "section" = 170, base_airport = null, "position" = '50174016', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 75027;
update personnel_v2.flight_info set category = 41, "section" = 170, base_airport = null, "position" = '50173741', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 78514;
update personnel_v2.flight_info set category = 35, "section" = 84, base_airport = 221, "position" = '50217376', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 78681;
update personnel_v2.flight_info set category = 37, "section" = 162, base_airport = null, "position" = '50179910', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 78936;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217374', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 81937;
update personnel_v2.flight_info set category = 38, "section" = 1, base_airport = null, "position" = '50190401', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 85064;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50198927', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 85111;
update personnel_v2.flight_info set category = 38, "section" = 76, base_airport = 181, "position" = '50211170', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 85560;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217352', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 86987;
update personnel_v2.flight_info set category = 38, "section" = 76, base_airport = 181, "position" = '50211328', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 87229;
update personnel_v2.flight_info set category = 71, "section" = 84, base_airport = 221, "position" = '50158620', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 87738;
update personnel_v2.flight_info set category = 14, "section" = 328, base_airport = null, "position" = '50207609', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 88134;
update personnel_v2.flight_info set category = 38, "section" = 436, base_airport = null, "position" = '50209962', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 90046;
update personnel_v2.flight_info set category = 35, "section" = 433, base_airport = null, "position" = '50193706', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 90141;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50215835', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 90186;
update personnel_v2.flight_info set category = 35, "section" = 430, base_airport = null, "position" = '50193703', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 90206;
update personnel_v2.flight_info set category = 35, "section" = 434, base_airport = null, "position" = '50193707', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 90309;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201635', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 92212;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199771', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 92213;
update personnel_v2.flight_info set category = 81, "section" = 385, base_airport = 3010, "position" = '99999999', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 92262;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50215963', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 92370;
update personnel_v2.flight_info set category = 38, "section" = 169, base_airport = null, "position" = '50176415', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 92491;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50201495', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 92515;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208872', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 92663;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209205', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 93110;
update personnel_v2.flight_info set category = 35, "section" = 84, base_airport = 221, "position" = '50217370', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 93192;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217351', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 93402;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165552', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 93628;
update personnel_v2.flight_info set category = 35, "section" = 432, base_airport = null, "position" = '50193705', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 93665;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203876', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 93760;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209286', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 94311;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203935', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 94349;
update personnel_v2.flight_info set category = 81, "section" = 385, base_airport = 3010, "position" = '99999999', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 94740;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50163740', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 94947;
update personnel_v2.flight_info set category = 38, "section" = 428, base_airport = null, "position" = '50193849', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 95451;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50214979', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 95690;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209512', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 95954;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50172430', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 96110;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208880', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 96287;
update personnel_v2.flight_info set category = 30, "section" = 144, base_airport = null, "position" = '50000734', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 96579;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217398', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 97087;
update personnel_v2.flight_info set category = 38, "section" = 428, base_airport = null, "position" = '50193900', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 97121;
update personnel_v2.flight_info set category = 38, "section" = 95, base_airport = null, "position" = '50217100', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 97764;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50193170', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 97814;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50215965', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 98090;
update personnel_v2.flight_info set category = 09, "section" = 34, base_airport = 141, "position" = '50197960', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 98613;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50163723', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 98757;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50200053', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 98906;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50214985', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 99166;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50211466', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 99568;
update personnel_v2.flight_info set category = 38, "section" = 185, base_airport = null, "position" = '50172630', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 100224;
update personnel_v2.flight_info set category = 38, "section" = 84, base_airport = 221, "position" = '50217396', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 100270;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50197020', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 101446;
update personnel_v2.flight_info set category = 38, "section" = 185, base_airport = null, "position" = '50217419', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 101922;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209158', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 102086;
update personnel_v2.flight_info set category = 09, "section" = 34, base_airport = 141, "position" = '50197949', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 102167;
update personnel_v2.flight_info set category = 38, "section" = 169, base_airport = null, "position" = '50176327', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 102534;
update personnel_v2.flight_info set category = 38, "section" = 169, base_airport = null, "position" = '50176383', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 102897;
update personnel_v2.flight_info set category = 83, "section" = 385, base_airport = 3010, "position" = '99999999', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 103034;
update personnel_v2.flight_info set category = 38, "section" = 15, base_airport = null, "position" = '50180832', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 103109;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50198060', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 103144;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200608', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 103214;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50198005', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 103575;
update personnel_v2.flight_info set category = 35, "section" = 431, base_airport = null, "position" = '50193704', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 103683;
update personnel_v2.flight_info set category = 07, "section" = 387, base_airport = 3012, "position" = '50201215', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 104905;
update personnel_v2.flight_info set category = 40, "section" = 170, base_airport = null, "position" = '50173749', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 104963;
update personnel_v2.flight_info set category = 38, "section" = 85, base_airport = null, "position" = '50182362', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 105420;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199721', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 105671;
update personnel_v2.flight_info set category = 38, "section" = 95, base_airport = null, "position" = '50205954', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 106171;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209238', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 106403;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50164973', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 108036;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203991', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 108092;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165553', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 108280;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50197992', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 108365;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50164929', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 109000;
update personnel_v2.flight_info set category = 51, "section" = 390, base_airport = 3030, "position" = '99999999', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 110470;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50197870', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 110612;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208723', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 111000;
update personnel_v2.flight_info set category = 08, "section" = 34, base_airport = 141, "position" = '50203745', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 111180;
update personnel_v2.flight_info set category = 38, "section" = 427, base_airport = null, "position" = '50193065', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 111436;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50164819', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 111585;
update personnel_v2.flight_info set category = 40, "section" = 170, base_airport = null, "position" = '50174000', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 111623;
update personnel_v2.flight_info set category = 40, "section" = 170, base_airport = null, "position" = '50173747', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 111828;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165505', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 112135;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203334', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 112171;
update personnel_v2.flight_info set category = 38, "section" = 121, base_airport = null, "position" = '50190872', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 112182;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50164346', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 115940;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209331', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 116282;
update personnel_v2.flight_info set category = 38, "section" = 435, base_airport = null, "position" = '50194764', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 116289;
update personnel_v2.flight_info set category = 71, "section" = 76, base_airport = 181, "position" = '50163476', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 117113;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192041', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118103;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188952', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118104;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165113', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118105;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188886', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118133;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164598', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118140;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188889', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118151;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192061', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118152;
update personnel_v2.flight_info set category = 98, "section" = 410, base_airport = null, "position" = '50104511', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118160;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164756', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118165;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50169939', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118178;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192072', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118179;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188885', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118204;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164624', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118243;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188891', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 118361;
update personnel_v2.flight_info set category = 37, "section" = 15, base_airport = null, "position" = '50215440', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121053;
update personnel_v2.flight_info set category = 38, "section" = 435, base_airport = null, "position" = '50194732', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121230;
update personnel_v2.flight_info set category = 98, "section" = 410, base_airport = null, "position" = '99999999', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121248;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50167781', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121337;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164725', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121362;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188887', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121421;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165268', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121537;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192034', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121550;
update personnel_v2.flight_info set category = 38, "section" = 435, base_airport = null, "position" = '50194767', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121567;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50164811', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121644;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192084', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121835;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192086', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121840;
update personnel_v2.flight_info set category = 98, "section" = 410, base_airport = null, "position" = '50138301', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121853;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188888', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 121855;
update personnel_v2.flight_info set category = 38, "section" = 106, base_airport = null, "position" = '50193639', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 122271;
update personnel_v2.flight_info set category = 38, "section" = 417, base_airport = null, "position" = '50192841', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 122299;
update personnel_v2.flight_info set category = 38, "section" = 427, base_airport = null, "position" = '50193070', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 122399;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199798', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 122508;
update personnel_v2.flight_info set category = 38, "section" = 34, base_airport = 141, "position" = '50197887', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 123691;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202609', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 123800;
update personnel_v2.flight_info set category = 38, "section" = 425, base_airport = null, "position" = '50186087', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 123835;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201772', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 123851;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201981', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 123879;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204979', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 123912;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199757', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 123950;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199746', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 124076;
update personnel_v2.flight_info set category = 38, "section" = 90, base_airport = null, "position" = '50178515', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 124284;
update personnel_v2.flight_info set category = 38, "section" = 1, base_airport = null, "position" = '50210350', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 124488;
update personnel_v2.flight_info set category = 51, "section" = 390, base_airport = 3030, "position" = '99999999', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 124949;
update personnel_v2.flight_info set category = 07, "section" = 387, base_airport = 3012, "position" = '50201233', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 125623;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199840', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 125638;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204980', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 125878;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50205004', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 126002;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204983', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 126205;
update personnel_v2.flight_info set category = 38, "section" = 121, base_airport = null, "position" = '50190909', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 126266;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208579', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 126424;
update personnel_v2.flight_info set category = 38, "section" = 435, base_airport = null, "position" = '50194760', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 126677;
update personnel_v2.flight_info set category = 38, "section" = 186, base_airport = null, "position" = '50207754', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127033;
update personnel_v2.flight_info set category = 38, "section" = 153, base_airport = null, "position" = '50181875', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127197;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199693', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127263;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199489', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127350;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164567', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127383;
update personnel_v2.flight_info set category = 38, "section" = 121, base_airport = null, "position" = '50191078', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127404;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50205120', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127459;
update personnel_v2.flight_info set category = 38, "section" = 169, base_airport = null, "position" = '50176446', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127606;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164606', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127739;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165083', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127805;
update personnel_v2.flight_info set category = 83, "section" = 385, base_airport = 3010, "position" = '50195419', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127923;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50199841', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 127953;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164520', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128023;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204982', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128060;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50205122', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128196;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202940', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128246;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188966', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128456;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164512', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128503;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50005933', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128508;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164529', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128515;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50005970', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128535;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165102', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128570;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203896', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128596;
update personnel_v2.flight_info set category = 38, "section" = 95, base_airport = null, "position" = '50192443', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128745;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50006115', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128817;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50188886', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128822;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164163', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128825;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164179', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128827;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50165154', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128841;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50164977', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128842;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164191', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128853;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50211534', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128889;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50078790', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128894;
update personnel_v2.flight_info set category = 81, "section" = 76, base_airport = 181, "position" = '50211468', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128896;
update personnel_v2.flight_info set category = 83, "section" = 76, base_airport = 181, "position" = '50164684', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 128897;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202933', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129049;
update personnel_v2.flight_info set category = 38, "section" = 19, base_airport = null, "position" = '50211149', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129052;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203641', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129104;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204066', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129113;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203817', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129125;
update personnel_v2.flight_info set category = 38, "section" = 186, base_airport = null, "position" = '50191271', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129128;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203827', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129180;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202501', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129216;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202350', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129223;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204693', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129227;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204778', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129228;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204796', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129229;
update personnel_v2.flight_info set category = 80, "section" = 403, base_airport = null, "position" = '50104559', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129302;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192068', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129303;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208739', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129350;
update personnel_v2.flight_info set category = 87, "section" = 76, base_airport = 181, "position" = '50192071', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129361;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200382', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129399;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200884', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129400;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202017', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129411;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200944', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129412;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202359', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129413;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202445', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129414;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202470', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129415;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203593', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129416;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200743', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129417;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202001', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129418;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200864', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129419;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201719', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129420;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200552', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129421;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201985', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129422;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203861', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129423;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202463', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129424;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202643', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129425;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203404', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129426;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200762', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129429;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200726', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129430;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200763', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129432;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200766', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129435;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201807', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129437;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201809', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129438;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201829', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129439;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203562', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129440;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201841', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129443;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203566', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129445;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203572', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129446;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203577', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129447;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203814', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129448;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203783', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129449;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209212', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129480;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204062', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129540;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203994', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129542;
update personnel_v2.flight_info set category = 38, "section" = 28, base_airport = null, "position" = '50209287', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129564;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50200507', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129594;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50172170', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129666;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50204108', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129667;
update personnel_v2.flight_info set category = 31, "section" = 143, base_airport = null, "position" = '50000726', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129668;
update personnel_v2.flight_info set category = 38, "section" = 186, base_airport = null, "position" = '50207750', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129671;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50172466', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129683;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50172467', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129687;
update personnel_v2.flight_info set category = 38, "section" = 186, base_airport = null, "position" = '50207599', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129688;
update personnel_v2.flight_info set category = 38, "section" = 121, base_airport = null, "position" = '50190911', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129689;
update personnel_v2.flight_info set category = 47, "section" = 416, base_airport = null, "position" = '50197443', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129690;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50215983', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129691;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50215984', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129692;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50172169', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129698;
update personnel_v2.flight_info set category = 38, "section" = 422, base_airport = null, "position" = '50216005', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129700;
update personnel_v2.flight_info set category = 38, "section" = 418, base_airport = null, "position" = '50217219', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129701;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208075', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129702;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208278', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129703;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208271', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129704;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208053', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129705;
update personnel_v2.flight_info set category = 44, "section" = 28, base_airport = null, "position" = '50208044', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129706;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201035', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129767;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50201038', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129779;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202450', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129783;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50202449', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129784;
update personnel_v2.flight_info set category = 07, "section" = 34, base_airport = 141, "position" = '50203448', expired = false, update_user = 'SYSTEM', update_date = now() where employee_number = 129787;


2.4.4. Сгененировать обновление для таблицы personnel_object_link (должности)
2.4.4.1. Заполнить файл EXCEL для сравнения:
1.	
1.	Получить данные из запроса из таблиц парсинга на тесте
 
--
select * from (
select
    ids, begda, endda, objid, id, creationtime
    , row_number() over (partition by ids ORDER BY creationtime desc) id_rn
from unnest(array[    3488,5702,11603,12456,14227,14238,15186,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92262,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94740,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98286,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102248,102257,102271,102450,102472,102534,102587,102591,102626,102627,102628,102634,102691,102719,102775,102796,102798,102807,102809,102854,102897,103034,103079,103109,103112,103121,103144,103214,103228,103252,103321,103508,103533,103575,103683,103685,103750,104245,104277,104285,104298,104401,104420,104584,104642,104650,104676,104688,104707,104807,104812,104885,104901,104905,104916,104925,104926,104963,104975,105043,105102,105163,105205,105212,105224,105320,105327,105329,105333,105412,105420,105488,105521,105540,105633,105648,105669,105671,105698,105699,105882,105893,105908,105933,105940,105949,105953,106010,106077,106084,106096,106171,106175,106293,106297,106403,106428,106479,106508,106523,106526,106572,106581,106601,106666,106677,106678,107639,107803,107818,107836,107845,107848,107888,107896,107934,107961,108021,108036,108071,108091,108092,108093,108094,108110,108181,108238,108265,108280,108309,108351,108355,108365,108374,108469,108472,108476,108477,108492,108571,108573,108626,108631,108700,108743,108746,108893,108897,108902,108973,108976,108980,109000,109065,109470,109479,109513,109690,109784,109934,110092,110185,110194,110220,110255,110358,110438,110470,110580,110610,110612,110891,110902,110920,110921,110928,110958,110962,110999,111000,111001,111180,111182,111187,111227,111242,111379,111436,111514,111552,111585,111589,111623,111828,111935,111959,111999,112094,112100,112135,112171,112182,112640,115940,116038,116282,116289,116346,116399,116524,116561,116571,116577,116582,116604,116616,116619,116625,116640,116642,116646,116650,116656,116659,116662,116704,116725,116742,116746,116748,116752,116753,116766,116783,116785,116788,116791,116799,116824,116825,116826,116831,116835,116838,116842,116844,116846,116847,116852,116858,116896,116897,116900,116905,116908,116909,116921,116923,116933,116937,116949,116950,116960,116977,116984,116985,116996,117001,117002,117006,117012,117039,117043,117053,117054,117062,117063,117066,117070,117071,117073,117074,117075,117076,117077,117080,117083,117084,117089,117093,117113,117129,117130,117132,117134,117135,117138,117140,117143,117148,117149,117151,117152,117153,117154,117155,117249,117253,117255,117262,117266,117267,117270,117271,117314,117317,117327,117333,117338,117345,117361,117362,117415,117416,117417,117419,117422,117425,117427,117431,117432,117435,117436,117439,117441,117460,117462,117463,117465,117466,117468,117470,117487,117488,117489,117490,117494,117496,117497,117499,117682,117685,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121248,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122417,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,124949,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129049,129052,129104,129113,129125,129128,129180,129206,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129666,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
]) ids
left join public.parced_hrmd_lines_2 phl 
on p_code = 'P1001'
and subty = 'A008'
and sobid = LPAD(ids::text,8,'0')
and endda = '99991231'
and raw_message_id not like 'P%'  --убрать опорные выгрузки
) sorted 
where sorted.id_rn = 1
and id is not null
order by 1, creationtime;
2.	Получить данные из запроса из ms-personnel (основной запрос но с другими полями и and pol.expired=false)
В запрос надо подставить список табельников из предыдущего пункта, так как стоит сравнивать только те табельные номера, обновления по которым пришли из САПа
Основной запрос для проверки данных 
----Запрос для Персонала по title_dep_summary и personnel_object_link-------
select 
       tds.title_id, tds.title, en, pol.expired, pol.obj_id1  --для сравнения должностей в excel
FROM UNNEST(ARRAY[
    --сюда подставить список табельников, которые надо проверить      3488,5702,11603,12456,14227,14238,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102534,102897,103109,103144,103214,103575,103683,104905,104963,105420,105671,106171,106403,108036,108092,108280,108365,109000,110612,111000,111180,111436,111585,111623,111828,112135,112171,112182,115940,116282,116289,117113,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129052,129104,129113,129125,129128,129180,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
    ]) AS en
left join personnel_v2.employee e on e.employee_number = en
left join personnel_v2.flight_info fi on fi.employee_number = en and fi.expired = false
left join personnel_v2.availability a on a.employee_number = en and a.end_date = '9999-01-01'
left join personnel_v2.communication com_t on com_t.employee_number = en and com_t."type" = 18 /*номер телефона*/ and com_t.expired = false
left join personnel_v2.communication com_e on com_e.employee_number = en and com_e."type" = 29 /*email*/ and com_e.expired = false
left join personnel_v2.title_dep_summary tds on tds.employee_number = e.employee_number 
left join personnel_v2.personnel_object_link pol on pol.type = 'A008' 
--    and pol.expired=false --только актуальные записи в personnel_object_link. Закомментировать для сравнения должностей в excel
    and pol.obj_id2 = LPAD(e.employee_number::text,8,'0')
left join (select j.employee_number, json_agg(j.*) international_passport_json from 
    (select ip.id, ip.employee_number, ip.emp_name, ip.emp_surname, ip.series, ip."number", ip.availability_status availability_status_id, ips."name" availability_status, ip.not_available_date, ip.issued_by, ip.issue_date, ip.expiration_date, ip.expired, ip."source", ip.emp_patronymic, ip.birth_place, ip.birth_place_eng, ip.mcl_usa, ip."comment", ip.seqnr, ip.issued_by_eng 
    from personnel_v2.international_passport ip left join personnel_v2.international_passport_status ips on ips.id = ip.availability_status 
    where 1 = 1 and ip.expiration_date > now()) j group by j.employee_number
    ) ips on ips.employee_number = e.employee_number
left join (select j.employee_number, json_agg(j.*) pass_json from 
    (select p.id, p.employee_number, p.start_date, p.end_date, p.pass_id, p.type type_id, pt."name" type, p.status status_id, ps.name status, p.stop_date, p.reff_id, p."source", p."name", p.surname
    from personnel_v2.pass p left join personnel_v2.pass_status ps on ps.id = p.status left join personnel_v2.pass_type pt on pt.id = p."type" 
    where 1=1 and p.end_date > now()) j group by j.employee_number
    ) jp on jp.employee_number = e.employee_number
left join (SELECT j.employee_number, json_agg(row_to_json(j) ORDER BY j.date_start ASC) AS dep_position_info_json 
    FROM (SELECT dpi.id, dpi.employee_number, dpi.department_name, dpi.position_name, dpi.date_start, dpi.date_end, dpi.is_deleted, dpi.employee_position_type 
    FROM personnel_v2.department_position_info dpi) j GROUP BY j.employee_number
    ) jdpi on jdpi.employee_number = e.employee_number
where 1=1
--and e."type" = 2 and e.status = 1  --только работающие БП
order by en
--    e.employee_number
;
----Запрос для Персонала по title_dep_summary и personnel_object_link------

3.	Перенести данные из запросов в excel (слева из m-personnel, справа из парсера)
Удалить лишние строки в середине (чтобы не было #Н/Д)
1.	Файл Excel v 1.0  
1.	Сравнение должностей при заливке персонала v.1.0.xlsx
2.	Файл Excel v 1.1 
1.	Сравнение должностей при заливке персонала v.1.1.xlsx
4.	Далее сгенерировать обновления анализируя файл
2.4.4.2. Анализ файла Excel
2.4.4.2.1. Анализ записей с одинаковыми табельными номерами
1.	Сделать фильтр Повтор = ИСТИНА
2.	Если у пачки строк с одинаковыми табельниками есть строка с NOTHING = ИСТИНА и другие строки с expired = true => значит для этого табельника уже есть одна актуальная запись и у неё правильная должность 
1.	Если если другие строки с expired = false, то для них надо сгенерировать скрипт, чтобы эти строки стали expired = true (Взять из столбца Expiring) 
1.	Пример:
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00003488' and obj_id1 = '50163402';
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00015223' and obj_id1 = '50165584';
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00086987' and obj_id1 = '50165585';
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00087738' and obj_id1 = '50163443';
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00093402' and obj_id1 = '50165583';
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00096579' and obj_id1 = '50074734';
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00121362' and obj_id1 = '50192071';
update personnel_v2.personnel_object_link pol set expired = true, update_user = 'SYSTEM', update_date = now() where pol.type = 'A008' and obj_id2 = '00126002' and obj_id1 = '50201672';
3.	Если у пачки строк с одинаковыми табельниками нет строки с NOTHING = ИСТИНА, то  
1.	Если есть RENEW = ИСТИНА, значит надо сгенерировать обновление (восстановление неактуальной записи) (RENEW) через скрипт из таблиц парсинга
1.	Тут просто записать нужные табельники. Сами скрипты можно сгенерировать сразу по всем табельникам позднее. 
1.	Пример: 85560,94947
2.	Если если другие строки с expired = false, то для них надо сгенерировать скрипт, чтобы эти строки стали expired = true (Взять из столбца Expiring)
2.	Если есть RENEW = ЛОЖЬ и (UPDATE и/или UPDATE_exp) = ИСТИНА, значит надо сгенерировать обновление актуальной (UPDATE) через скрипт из таблиц парсинга
1.	Тут просто записать нужные табельники. Сами скрипты можно сгенерировать сразу по всем табельникам позднее.
1.	Пример: 101922,117113
3.	Если есть (RENEW и UPDATE и UPDATE_exp) = ЛОЖЬ и INSERT = ИСТИНА, значит надо сгенерировать добавление (INSERT) через скрипт из таблиц парсинга
Тут просто записать нужные табельники. Сами скрипты можно сгенерировать сразу по всем табельникам позднее.
1.	Пример: 129435
2.4.4.2.2. Анализ записей с разными табельными номерами
1.	Сделать фильтр Повтор = Пусто
2.	Сделать фильтр INSERT = ИСТИНА. Для всех найденных табельников надо сгенерировать добавление через скрипт из таблиц парсинга
1.	Пример: 14238,25480,34607,54868,66063,66504,75027,90046,90141,90206,90309,92491,92663,93665,95451,96287,97121,99166,100224,102534,103109,103683,112182,116282,118103,118104,118133,118151,118160,118178,118179,118204,118361,121053,121230,121337,121421,121550,121567,121835,121840,121853,121855,122271,123835,126266,126677,127404,127606,128456,128503,128508,128515,128535,128570,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129125,129180,129423,129429,129430,129432,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129767,129779,129783,129784,129787
3.	Снять фильтр INSERT = ИСТИНА
4.	Сделать фильтр UPDATE = ИСТИНА. Для всех найденных табельников надо сгенерировать обновление через скрипт из таблиц парсинга
1.	Пример:
5702,15306,93628,106171,108280,109000,111000,112135,115940,121537,121644,122508,123691,124076,127739,127805,128023,128246,128596
5.	Снять фильтр UPDATE= ИСТИНА
6.	Сделать фильтр UPDATE_exp = ИСТИНА. Для всех найденных табельников надо сгенерировать обновление неактивной записи через скрипт из таблиц парсинга
1.	Пример:
12456,44494,97814,98757,99568,108036,111585,127263
7.	Снять фильтр UPDATE_exp = ИСТИНА
8.	Сделать фильтр RENEW = ИСТИНА. Для всех найденных табельников надо сгенерировать восстановление неактуальной записи через скрипт из таблиц парсинга 
1.	Пример:
47141
9.	Снять все фильтры
2.4.4.3. Генерация скриптов
2.4.4.3.1. восстановление неактуальной записи (RENEW)
RENEW 
--Восстановить актуальные должности в personnel_object_link для 128675,128611,128596,129177,128704,128677,128689  
select * from (
select ids
    , row_number() over (partition by ids ORDER BY creationtime desc) id_rn
    , 'update personnel_v2.personnel_object_link set expired = true, update_user = ''SYSTEM'', update_date = now() where type = '''||subty||''' and obj_id2 = '''||sobid||'''; update personnel_v2.personnel_object_link set obj_type1 = '''||otype||''', obj_type2 = '''||sclas||''', expired = false, update_user = ''SYSTEM'', update_date = now() where type = '''||subty||''' and obj_id2 = '''||sobid||''' and obj_id1 = '''||objid||''';'
    sql_update_personnel_object_link
    ,id,begda,endda,objid,opera,otype,sclas,seqnr,sobid,subty,create_date,created_by,creationtime,idocnum,p_code,raw_message_id
from unnest(array[47141,85560,94947  ]) ids
left join public.parced_hrmd_lines_2 phl 
on p_code = 'P1001'
and subty = 'A008'
and sobid = LPAD(ids::text,8,'0')
and endda = '99991231'
and raw_message_id not like 'P%'  --убрать опорные выгрузки
) sorted 
where sorted.id_rn = 1
order by 1, creationtime;
2.4.4.3.1.1. Пример сгенерированных обновлений
RENEW пример 
update personnel_v2.personnel_object_link set expired = true, update_user = 'SYSTEM', update_date = now() where type = 'A008' and obj_id2 = '00047141'; update personnel_v2.personnel_object_link set obj_type1 = 'S', obj_type2 = 'P', expired = false, update_user = 'SYSTEM', update_date = now() where type = 'A008' and obj_id2 = '00047141' and obj_id1 = '50202951';
update personnel_v2.personnel_object_link set expired = true, update_user = 'SYSTEM', update_date = now() where type = 'A008' and obj_id2 = '00085560'; update personnel_v2.personnel_object_link set obj_type1 = 'S', obj_type2 = 'P', expired = false, update_user = 'SYSTEM', update_date = now() where type = 'A008' and obj_id2 = '00085560' and obj_id1 = '50211170';
update personnel_v2.personnel_object_link set expired = true, update_user = 'SYSTEM', update_date = now() where type = 'A008' and obj_id2 = '00094947'; update personnel_v2.personnel_object_link set obj_type1 = 'S', obj_type2 = 'P', expired = false, update_user = 'SYSTEM', update_date = now() where type = 'A008' and obj_id2 = '00094947' and obj_id1 = '50163740';
2.4.4.3.2. обновление неактивной записи (UPDATE_exp)
UPDATE_exp 
--Обновить должности в personnel_object_link для   
select * from (
select
--    ids, begda, endda, objid, id, creationtime
    ids
    , row_number() over (partition by ids ORDER BY creationtime desc) id_rn
--    , 'update personnel_v2.personnel_object_link set obj_id1 = '''||objid||''', obj_type1 = '''||otype||''', obj_type2 = '''||sclas||''', update_user = ''SYSTEM'', update_date = now() where expired = false and type = '''||subty||''' and obj_id2 = '''||sobid||''';'
--    sql_update_personnel_object_link_where_not_expired
    , 'update personnel_v2.personnel_object_link set obj_id1 = '''||objid||''', obj_type1 = '''||otype||''', obj_type2 = '''||sclas||''', update_user = ''SYSTEM'', update_date = now(), expired = false where type = '''||subty||''' and obj_id2 = '''||sobid||''';'
    sql_update_personnel_object_link_where_is_one
    ,id,begda,endda,objid,opera,otype,sclas,seqnr,sobid,subty,create_date,created_by,creationtime,idocnum,p_code,raw_message_id
from unnest(array[
    12456,44494,97814,98757,99568,108036,111585,127263
]) ids
left join public.parced_hrmd_lines_2 phl 
on p_code = 'P1001'
and subty = 'A008'
and sobid = LPAD(ids::text,8,'0')
and endda = '99991231'
and raw_message_id not like 'P%'  --убрать опорные выгрузки
) sorted 
where sorted.id_rn = 1
and id is not null
order by 1, creationtime;
2.4.4.3.2.1. Пример сгенерированных обновлений
UPDATE_exp пример 
update personnel_v2.personnel_object_link set obj_id1 = '50164279', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00012456';
update personnel_v2.personnel_object_link set obj_id1 = '50217506', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00044494';
update personnel_v2.personnel_object_link set obj_id1 = '50193170', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00097814';
update personnel_v2.personnel_object_link set obj_id1 = '50163723', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00098757';
update personnel_v2.personnel_object_link set obj_id1 = '50211466', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00099568';
update personnel_v2.personnel_object_link set obj_id1 = '50164973', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00108036';
update personnel_v2.personnel_object_link set obj_id1 = '50164819', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00111585';
update personnel_v2.personnel_object_link set obj_id1 = '50199693', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now(), expired = false where type = 'A008' and obj_id2 = '00127263';
2.4.4.3.3. обновление активной записи (UPDATE)
UPDATE 
--Обновить должности в personnel_object_link для   
select * from (
select
--    ids, begda, endda, objid, id, creationtime
    ids
    , row_number() over (partition by ids ORDER BY creationtime desc) id_rn
    , 'update personnel_v2.personnel_object_link set obj_id1 = '''||objid||''', obj_type1 = '''||otype||''', obj_type2 = '''||sclas||''', update_user = ''SYSTEM'', update_date = now() where expired = false and type = '''||subty||''' and obj_id2 = '''||sobid||''';'
    sql_update_personnel_object_link_where_not_expired
--    , 'update personnel_v2.personnel_object_link set obj_id1 = '''||objid||''', obj_type1 = '''||otype||''', obj_type2 = '''||sclas||''', update_user = ''SYSTEM'', update_date = now(), expired = false where type = '''||subty||''' and obj_id2 = '''||sobid||''';'
--    sql_update_personnel_object_link_where_is_one
    ,id,begda,endda,objid,opera,otype,sclas,seqnr,sobid,subty,create_date,created_by,creationtime,idocnum,p_code,raw_message_id
from unnest(array[
    101922,117113,5702,15306,93628,106171,108280,109000,111000,112135,115940,121537,121644,122508,123691,124076,127739,127805,128023,128246,128596
]) ids
left join public.parced_hrmd_lines_2 phl 
on p_code = 'P1001'
and subty = 'A008'
and sobid = LPAD(ids::text,8,'0')
and endda = '99991231'
and raw_message_id not like 'P%'  --убрать опорные выгрузки
) sorted 
where sorted.id_rn = 1
and id is not null
order by 1, creationtime;
2.4.4.3.3.1. Пример сгенерированных обновлений
UPDATE пример 
update personnel_v2.personnel_object_link set obj_id1 = '50211374', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00005702';
update personnel_v2.personnel_object_link set obj_id1 = '50165315', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00015306';
update personnel_v2.personnel_object_link set obj_id1 = '50165552', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00093628';
update personnel_v2.personnel_object_link set obj_id1 = '50217419', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00101922';
update personnel_v2.personnel_object_link set obj_id1 = '50205954', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00106171';
update personnel_v2.personnel_object_link set obj_id1 = '50165553', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00108280';
update personnel_v2.personnel_object_link set obj_id1 = '50164929', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00109000';
update personnel_v2.personnel_object_link set obj_id1 = '50208723', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00111000';
update personnel_v2.personnel_object_link set obj_id1 = '50165505', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00112135';
update personnel_v2.personnel_object_link set obj_id1 = '50164346', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00115940';
update personnel_v2.personnel_object_link set obj_id1 = '50163476', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00117113';
update personnel_v2.personnel_object_link set obj_id1 = '50165268', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00121537';
update personnel_v2.personnel_object_link set obj_id1 = '50164811', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00121644';
update personnel_v2.personnel_object_link set obj_id1 = '50199798', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00122508';
update personnel_v2.personnel_object_link set obj_id1 = '50197887', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00123691';
update personnel_v2.personnel_object_link set obj_id1 = '50199746', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00124076';
update personnel_v2.personnel_object_link set obj_id1 = '50164606', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00127739';
update personnel_v2.personnel_object_link set obj_id1 = '50165083', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00127805';
update personnel_v2.personnel_object_link set obj_id1 = '50164520', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00128023';
update personnel_v2.personnel_object_link set obj_id1 = '50202940', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00128246';
update personnel_v2.personnel_object_link set obj_id1 = '50162994', obj_type1 = 'S', obj_type2 = 'P', update_user = 'SYSTEM', update_date = now() where expired = false and type = 'A008' and obj_id2 = '00128596';
2.4.4.3.4. добавление (INSERT)
INSERT 
--Заполнить должности в personnel_object_link для 
select 1 ids,1 id_rn,'INSERT INTO personnel_v2.personnel_object_link (obj_id1, obj_type1, obj_id2, obj_type2, "type", expired, editable, create_user, create_date, update_user, update_date) VALUES'
    sql_insert_personnel_object_link
    , null id, null begda, null endda, null objid, null opera, null otype, null sclas, null seqnr, null sobid, null subty, null create_date, null created_by, null creationtime, null idocnum, null p_code, null raw_message_id
union all
select * from (
select ids
    , row_number() over (partition by ids ORDER BY creationtime desc) id_rn
    , '('''||objid||''',''S'','''||sobid||''',''P'',''A008'',false,false,''SYSTEM'',now(),''SYSTEM'',now()),'
    sql_insert_personnel_object_link
    ,id,begda,endda,objid,opera,otype,sclas,seqnr,sobid,subty,create_date,created_by,creationtime,idocnum,p_code,raw_message_id
from unnest(array[ 
    129435,14238,25480,34607,54868,66063,66504,75027,90046,90141,90206,90309,92491,92663,93665,95451,96287,97121,99166,100224,102534,103109,103683,112182,116282,118103,118104,118133,118151,118160,118178,118179,118204,118361,121053,121230,121337,121421,121550,121567,121835,121840,121853,121855,122271,123835,126266,126677,127404,127606,128456,128503,128508,128515,128535,128570,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129125,129180,129423,129429,129430,129432,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129767,129779,129783,129784,129787
]) ids
left join public.parced_hrmd_lines_2 phl 
on p_code = 'P1001'
and subty = 'A008'
and sobid = LPAD(ids::text,8,'0')
and endda = '99991231'
and raw_message_id not like 'P%'  --убрать опорные выгрузки
) sorted 
where sorted.id_rn = 1
order by 1, creationtime;
2.4.4.3.4.1. Пример сгенерированных обновлений
INSERT пример 
INSERT INTO personnel_v2.personnel_object_link (obj_id1, obj_type1, obj_id2, obj_type2, "type", expired, editable, create_user, create_date, update_user, update_date) VALUES
('50176450','S','00014238','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50172180','S','00025480','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193592','S','00034607','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193638','S','00054868','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193709','S','00066063','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50214984','S','00066504','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50174016','S','00075027','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50194533','S','00090046','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193706','S','00090141','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193703','S','00090206','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193707','S','00090309','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50176415','S','00092491','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50208872','S','00092663','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193705','S','00093665','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193849','S','00095451','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50208880','S','00096287','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193900','S','00097121','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50214985','S','00099166','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50172630','S','00100224','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50176327','S','00102534','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50180832','S','00103109','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193704','S','00103683','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50190872','S','00112182','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50209331','S','00116282','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50192041','S','00118103','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188952','S','00118104','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188886','S','00118133','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188889','S','00118151','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50104511','S','00118160','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50169939','S','00118178','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50192072','S','00118179','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188885','S','00118204','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188891','S','00118361','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50215440','S','00121053','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50194732','S','00121230','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50167781','S','00121337','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188887','S','00121421','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50192034','S','00121550','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50194767','S','00121567','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50192084','S','00121835','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50192086','S','00121840','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50138301','S','00121853','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188888','S','00121855','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50193639','S','00122271','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50186087','S','00123835','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50190909','S','00126266','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50194760','S','00126677','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50191078','S','00127404','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50176446','S','00127606','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188966','S','00128456','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50164512','S','00128503','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50005933','S','00128508','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50164529','S','00128515','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50005970','S','00128535','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50165102','S','00128570','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50006115','S','00128817','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50188886','S','00128822','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50164163','S','00128825','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50164179','S','00128827','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50165154','S','00128841','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50164977','S','00128842','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50164191','S','00128853','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50211534','S','00128889','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50078790','S','00128894','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50211468','S','00128896','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50164684','S','00128897','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203817','S','00129125','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203827','S','00129180','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203861','S','00129423','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50200762','S','00129429','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50200726','S','00129430','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50200763','S','00129432','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50200766','S','00129435','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50201807','S','00129437','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50201809','S','00129438','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50201829','S','00129439','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203562','S','00129440','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50201841','S','00129443','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203566','S','00129445','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203572','S','00129446','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203577','S','00129447','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203814','S','00129448','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203783','S','00129449','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50201035','S','00129767','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50201038','S','00129779','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50202450','S','00129783','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50202449','S','00129784','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now()),
('50203448','S','00129787','P','A008',false,false,'SYSTEM',now(),'SYSTEM',now());  -- <---тут руками , меняем на ;
2.4.5. Сгененировать обновление для таблицы title_dep_summary (должности и подразделения):
title_dep_summary 
select personnel_v2.update_title_dep_summary('SYSTEM');
2.4.6. Сгененировать обновление для таблицы department_position_info (должности и тип сотрудника в прошлом)
Подставить список табельных номеров, для которых были сгенерированы обновления должностей в personnel_object_link 
department_position_info  
-----
--обновляем department_position_info
---1  у кого вообще нет записей
insert into personnel_v2.department_position_info (employee_number, position_name, department_name , date_start, employee_position_type)
select e.employee_number, tds.title, tds.department, e.create_date, 2
from 
(select * FROM UNNEST(ARRAY[ 3488,5702,11603,12456,14227,14238,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102534,102897,103109,103144,103214,103575,103683,104905,104963,105420,105671,106171,106403,108036,108092,108280,108365,109000,110612,111000,111180,111436,111585,111623,111828,112135,112171,112182,115940,116282,116289,117113,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129052,129104,129113,129125,129128,129180,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
]) AS en) ids
left join personnel_v2.employee e on e.employee_number = ids.en
left join personnel_v2.department_position_info dpi on dpi.employee_number = ids.en
left join personnel_v2.title_dep_summary tds on tds.employee_number = ids.en
where dpi.id is null and tds.id is not null;


---2 у кого срок действия закончился но не бесконечный
insert into personnel_v2.department_position_info (employee_number, position_name, department_name , date_start, employee_position_type)
select employee_number, title, department, (date_end+interval '1 day')::date, 2 from (
select
    row_number() over (partition by en order by date_start desc) rn
    , ids.en, e.type, e.status, dpi.id, dpi.employee_number, dpi.department_name, dpi.position_name, dpi.date_start, dpi.date_end, dpi.employee_position_type
    , tds.title, tds.department
from 
(select * FROM UNNEST(ARRAY[ 3488,5702,11603,12456,14227,14238,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102534,102897,103109,103144,103214,103575,103683,104905,104963,105420,105671,106171,106403,108036,108092,108280,108365,109000,110612,111000,111180,111436,111585,111623,111828,112135,112171,112182,115940,116282,116289,117113,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129052,129104,129113,129125,129128,129180,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
]) AS en) ids
left join personnel_v2.employee e on e.employee_number = ids.en
left join personnel_v2.department_position_info dpi on dpi.employee_number = ids.en
left join personnel_v2.title_dep_summary tds on tds.employee_number = ids.en
where dpi.id is not null and e.type = 2 and e.status = 1
) sorted 
where rn = 1 and date_end is not null;


---3 обновить у кого срок действия бесконечный, но не все поля заполнены
update personnel_v2.department_position_info 
set position_name = subquery.title
    , department_name = subquery.department
from (select * from (
select
    row_number() over (partition by en order by date_start desc) rn
    , ids.en, e.type, e.status, dpi.id, dpi.employee_number, dpi.department_name, dpi.position_name, dpi.date_start, dpi.date_end, dpi.employee_position_type
    , tds.title, tds.department
from 
(select * FROM UNNEST(ARRAY[ 3488,5702,11603,12456,14227,14238,15223,15306,19015,25480,33058,33324,33340,33358,33375,34202,34555,34607,34952,39868,44494,46610,46909,47141,47725,48293,49000,54868,64341,64735,65778,66063,66504,69754,75027,78514,78681,78936,81937,85064,85111,85560,86987,87229,87738,88134,90046,90141,90186,90206,90309,92212,92213,92370,92491,92515,92663,93110,93192,93402,93628,93665,93760,94311,94349,94947,95451,95690,95954,96110,96287,96579,97087,97121,97764,97814,98090,98613,98757,98906,99166,99568,100224,100270,101446,101922,102086,102167,102534,102897,103109,103144,103214,103575,103683,104905,104963,105420,105671,106171,106403,108036,108092,108280,108365,109000,110612,111000,111180,111436,111585,111623,111828,112135,112171,112182,115940,116282,116289,117113,118103,118104,118105,118133,118140,118151,118152,118160,118165,118178,118179,118204,118243,118361,121053,121230,121337,121362,121421,121537,121550,121567,121644,121835,121840,121853,121855,122271,122299,122399,122508,123691,123800,123835,123851,123879,123912,123950,124076,124284,124488,125623,125638,125878,126002,126205,126266,126424,126677,127033,127197,127263,127350,127383,127404,127459,127606,127739,127805,127923,127953,128023,128060,128196,128246,128456,128503,128508,128515,128535,128570,128596,128745,128817,128822,128825,128827,128841,128842,128853,128889,128894,128896,128897,129052,129104,129113,129125,129128,129180,129216,129223,129227,129228,129229,129302,129303,129350,129361,129399,129400,129411,129412,129413,129414,129415,129416,129417,129418,129419,129420,129421,129422,129423,129424,129425,129426,129429,129430,129432,129435,129437,129438,129439,129440,129443,129445,129446,129447,129448,129449,129480,129540,129542,129564,129594,129667,129668,129671,129683,129687,129688,129689,129690,129691,129692,129698,129700,129701,129702,129703,129704,129705,129706,129767,129779,129783,129784,129787
]) AS en) ids
left join personnel_v2.employee e on e.employee_number = ids.en
left join personnel_v2.department_position_info dpi on dpi.employee_number = ids.en
left join personnel_v2.title_dep_summary tds on tds.employee_number = ids.en
where dpi.id is not null and e.type = 2 and e.status = 1
) sorted 
where rn = 1 and date_end is null) subquery
where department_position_info.id = subquery.id;


2.5. Собрать скрипт
Собрать все сгенерированные обновления в один файл.
Название файла должно содержать дату обновления и версию (чтобы если при накатке на серт/прод появятся ошибки, то обновлённые файлы можно было передавать ДБА с новой версией)
2.5.1. Пример после генерации
Доливка в персонал 2026-01-31 - 1.0.sql
2.6. Проверка на деве
1.	Применить все скрипты на деве 
1.	Для дева скорее всего надо будет делать свою версию для должностей, так как таблица  personnel_object_link отличается от прода
2.	Проверить результат с помощью основного запроса: 
1.	Пройтись по всем сотрудникам из инцидентов и проверить, что у всех: 
1.	Заполнены дата рождения (не 1900 год) и гражданство (не UN)
2.	Заполнены должность и подразделения
3.	Доступность
4.	Указан базовый аэропорт
2.	Если всё ок, то собрать скрипт для прода и перейти к "Выкатка в прод"
3.	Если не ок, то нужна аналитика.
2.7. Выкатка в прод
1.	Согласовать применение скрипта на серте и проде 
1.	Подготовить релизную страницу (пример Шаблон наката доливки персонала [PROD] HotFix 1.40.14-data от 03.02.2026) отдельно для серта и для прода
2.	Передать для согласования
2.	Передать скрипт ДБА
3.	Убедиться с ДБА, что скрипт не вызывает ошибок. 
1.	Если ошибки возникают, значит надо разобраться в ошибке и доработать скрипт.
2.	Возврат к пункту "Передать скрипт ДБА"
4.	Проверить результат с помощью основного запроса

Черновик... 
Шаблон блока кода
 
---




