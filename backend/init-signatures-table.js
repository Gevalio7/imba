const { pool } = require('./config/db');
const Signatures = require('./models/signatures');

async function initSignaturesTable() {
  try {
    console.log('üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã signatures —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏...');

    // –ü–æ–ª—É—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–¥–ø–∏—Å–∏
    const existingData = await pool.query('SELECT name FROM signatures');
    const existingNames = existingData.rows.map(row => row.name);

    // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–µ–π
    const testSignatures = [
      {
        name: '–° —É–≤–∞–∂–µ–Ω–∏–µ–º',
        content: '\n\n–° —É–≤–∞–∂–µ–Ω–∏–µ–º,\n[–í–∞—à–µ –∏–º—è]\n[–í–∞—à–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å]\n[–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏]',
        comment: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å—å —Å —É–≤–∞–∂–µ–Ω–∏–µ–º',
        isActive: true
      },
      {
        name: '–õ—É—á—à–∏–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è',
        content: '\n\n–° –ª—É—á—à–∏–º–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏,\n[–í–∞—à–µ –∏–º—è]\n[–í–∞—à–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å]',
        comment: '–¢–µ–ø–ª–∞—è –ø–æ–¥–ø–∏—Å—å —Å –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏',
        isActive: true
      },
      {
        name: '–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ',
        content: '\n\n–°–ø–∞—Å–∏–±–æ –∑–∞ –í–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ!\n\n–° —É–≤–∞–∂–µ–Ω–∏–µ–º,\n[–í–∞—à–µ –∏–º—è]',
        comment: '–ü–æ–¥–ø–∏—Å—å —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é',
        isActive: true
      },
      {
        name: '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å—å',
        content: '\n\n–° —É–≤–∞–∂–µ–Ω–∏–µ–º,\n[–í–∞—à–µ –∏–º—è]\n[–í–∞—à–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å]\n[–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]\n[–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏]',
        comment: '–ü–æ–ª–Ω–∞—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å—å',
        isActive: true
      },
      {
        name: '–ö–æ—Ä–æ—Ç–∫–∞—è –ø–æ–¥–ø–∏—Å—å',
        content: '\n\n–° —É–≤–∞–∂–µ–Ω–∏–µ–º,\n[–í–∞—à–µ –∏–º—è]',
        comment: '–ö—Ä–∞—Ç–∫–∞—è –ø–æ–¥–ø–∏—Å—å',
        isActive: true
      },
      {
        name: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤',
        content: '\n\n–ö–æ–º–∞–Ω–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏\n[–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏]\n[–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]',
        comment: '–ü–æ–¥–ø–∏—Å—å –¥–ª—è —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏',
        isActive: true
      },
      {
        name: '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞',
        content: '\n\n–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞\n[–í–∞—à–µ –∏–º—è]\n[Email]\n[–¢–µ–ª–µ—Ñ–æ–Ω]',
        comment: '–ü–æ–¥–ø–∏—Å—å –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏',
        isActive: true
      },
      {
        name: '–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º',
        content: '\n\n–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º\n[–í–∞—à–µ –∏–º—è]\n[–¢–µ–ª–µ—Ñ–æ–Ω]\n[Email]',
        comment: '–ü–æ–¥–ø–∏—Å—å –¥–ª—è –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂',
        isActive: true
      }
    ];

    let addedCount = 0;

    console.log('üìù –í—Å—Ç–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...');

    for (const signature of testSignatures) {
      if (!existingNames.includes(signature.name)) {
        await Signatures.create(signature);
        console.log(`   ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–ø–∏—Å—å: ${signature.name}`);
        addedCount++;
      } else {
        console.log(`   ‚ÑπÔ∏è  –ü–æ–¥–ø–∏—Å—å "${signature.name}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);
      }
    }

    console.log('‚úÖ –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã signatures –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ');
    console.log(`   –î–æ–±–∞–≤–ª–µ–Ω–æ ${addedCount} –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π`);

    process.exit(0);
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã signatures:', error);
    process.exit(1);
  }
}

initSignaturesTable();
